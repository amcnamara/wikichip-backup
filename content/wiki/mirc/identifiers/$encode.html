<!DOCTYPE html><html class="client-nojs" lang="en" dir="ltr"><head><meta charset="UTF-8"/>
<script>var __ezHttpConsent={setByCat:function(src,tagType,attributes,category,force){var setScript=function(){if(force||window.ezTcfConsent[category]){var scriptElement=document.createElement(tagType);scriptElement.src=src;attributes.forEach(function(attr){for(var key in attr){if(attr.hasOwnProperty(key)){scriptElement.setAttribute(key,attr[key]);}}});var firstScript=document.getElementsByTagName(tagType)[0];firstScript.parentNode.insertBefore(scriptElement,firstScript);}};if(force||(window.ezTcfConsent&&window.ezTcfConsent.loaded)){setScript();}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){setScript();}else{console.error("cannot get ez consent data");force=true;setScript();}});}else{force=true;setScript();console.error("getEzConsentData is not a function");}},};</script>
<script>var ezTcfConsent=window.ezTcfConsent?window.ezTcfConsent:{loaded:false,store_info:false,develop_and_improve_services:false,measure_ad_performance:false,measure_content_performance:false,select_basic_ads:false,create_ad_profile:false,select_personalized_ads:false,create_content_profile:false,select_personalized_content:false,understand_audiences:false,use_limited_data_to_select_content:false,};function getEzConsentData(){return new Promise(function(resolve){document.addEventListener("ezConsentEvent",function(event){var ezTcfConsent=event.detail.ezTcfConsent;resolve(ezTcfConsent);});});}</script>
<script>function _setEzCookies(ezConsentData){var cookies=[{name:"ezoab_86609",value:"mod283-c; Path=/; Domain=wikichip.org; Expires=Thu, 30 May 2024 09:01:31 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"ezoadgid_86609",value:"-2; Path=/; Domain=wikichip.org; Expires=Thu, 30 May 2024 07:31:31 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezosuibasgeneris-1",value:"c474f95c-5fd9-4248-5d2c-7d02f8e8d30e; Path=/; Domain=wikichip.org; Expires=Fri, 30 May 2025 07:01:31 UTC; Secure; SameSite=None",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"active_template::86609",value:"pub_site.1717052491; Path=/; Domain=wikichip.org; Expires=Sat, 01 Jun 2024 07:01:31 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"ezopvc_86609",value:"1; Path=/; Domain=wikichip.org; Expires=Thu, 30 May 2024 07:31:32 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"lp_86609",value:"https://en.wikichip.org/wiki/mirc/identifiers/$encode; Path=/; Domain=wikichip.org; Expires=Thu, 30 May 2024 07:31:32 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"ezovuuidtime_86609",value:"1717052492; Path=/; Domain=wikichip.org; Expires=Sat, 01 Jun 2024 07:01:32 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezovuuid_86609",value:"e0b48073-8610-46fb-716e-0ee8ddcec584; Path=/; Domain=wikichip.org; Expires=Thu, 30 May 2024 07:31:32 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezoref_86609",value:"; Path=/; Domain=wikichip.org; Expires=Thu, 30 May 2024 07:31:32 UTC",tcfCategory:"understand_audiences",isEzoic:"true",}];for(var i=0;i<cookies.length;i++){var cookie=cookies[i];if(ezConsentData&&ezConsentData.loaded&&ezConsentData[cookie.tcfCategory]){document.cookie=cookie.name+"="+cookie.value;}}}
if(window.ezTcfConsent&&window.ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else{console.error("cannot get ez consent data");_setEzCookies(window.ezTcfConsent);}});}else{console.error("getEzConsentData is not a function");_setEzCookies(window.ezTcfConsent);}</script>
<script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>var __ez=__ez||{};__ez.stms=Date.now();__ez.evt={};__ez.script={};__ez.ck=__ez.ck||{};__ez.template={};__ez.template.isOrig=true;window.__ezScriptHost="//www.ezojs.com";__ez.queue=function(){var e=0,i=0,t=[],n=!1,o=[],r=[],s=!0,a=function(e,i,n,o,r,s,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,d=this;this.name=e,this.funcName=i,this.parameters=null===n?null:p(n)?n:[n],this.isBlock=o,this.blockedBy=r,this.deleteWhenComplete=s,this.isError=!1,this.isComplete=!1,this.isInitialized=!1,this.proceedIfError=a,this.fWindow=l,this.isTimeDelay=!1,this.process=function(){f("... func = "+e),d.isInitialized=!0,d.isComplete=!0,f("... func.apply: "+e);var i=d.funcName.split("."),n=null,o=this.fWindow||window;i.length>3||(n=3===i.length?o[i[0]][i[1]][i[2]]:2===i.length?o[i[0]][i[1]]:o[d.funcName]),null!=n&&n.apply(null,this.parameters),!0===d.deleteWhenComplete&&delete t[e],!0===d.isBlock&&(f("----- F'D: "+d.name),u())}},l=function(e,i,t,n,o,r,s){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,l=this;this.name=e,this.path=i,this.async=o,this.defer=r,this.isBlock=t,this.blockedBy=n,this.isInitialized=!1,this.isError=!1,this.isComplete=!1,this.proceedIfError=s,this.fWindow=a,this.isTimeDelay=!1,this.isPath=function(e){return"/"===e[0]&&"/"!==e[1]},this.getSrc=function(e){return void 0!==window.__ezScriptHost&&this.isPath(e)&&"banger.js"!==this.name?window.__ezScriptHost+e:e},this.process=function(){l.isInitialized=!0,f("... file = "+e);var i=this.fWindow?this.fWindow.document:document,t=i.createElement("script");t.src=this.getSrc(this.path),!0===o?t.async=!0:!0===r&&(t.defer=!0),t.onerror=function(){var e={url:window.location.href,name:l.name,path:l.path,user_agent:window.navigator.userAgent};"undefined"!=typeof _ezaq&&(e.pageview_id=_ezaq.page_view_id);var i=encodeURIComponent(JSON.stringify(e)),t=new XMLHttpRequest;t.open("GET","//g.ezoic.net/ezqlog?d="+i,!0),t.send(),f("----- ERR'D: "+l.name),l.isError=!0,!0===l.isBlock&&u()},t.onreadystatechange=t.onload=function(){var e=t.readyState;f("----- F'D: "+l.name),e&&!/loaded|complete/.test(e)||(l.isComplete=!0,!0===l.isBlock&&u())},i.getElementsByTagName("head")[0].appendChild(t)}},d=function(e,i){this.name=e,this.path="",this.async=!1,this.defer=!1,this.isBlock=!1,this.blockedBy=[],this.isInitialized=!0,this.isError=!1,this.isComplete=i,this.proceedIfError=!1,this.isTimeDelay=!1,this.process=function(){}};function c(e){!0!==h(e)&&0!=s&&e.process()}function h(e){if(!0===e.isTimeDelay&&!1===n)return f(e.name+" blocked = TIME DELAY!"),!0;if(p(e.blockedBy))for(var i=0;i<e.blockedBy.length;i++){var o=e.blockedBy[i];if(!1===t.hasOwnProperty(o))return f(e.name+" blocked = "+o),!0;if(!0===e.proceedIfError&&!0===t[o].isError)return!1;if(!1===t[o].isComplete)return f(e.name+" blocked = "+o),!0}return!1}function f(e){var i=window.location.href,t=new RegExp("[?&]ezq=([^&#]*)","i").exec(i);"1"===(t?t[1]:null)&&console.debug(e)}function u(){++e>200||(f("let's go"),m(o),m(r))}function m(e){for(var i in e)if(!1!==e.hasOwnProperty(i)){var t=e[i];!0===t.isComplete||h(t)||!0===t.isInitialized||!0===t.isError?!0===t.isError?f(t.name+": error"):!0===t.isComplete?f(t.name+": complete already"):!0===t.isInitialized&&f(t.name+": initialized already"):t.process()}}function p(e){return"[object Array]"==Object.prototype.toString.call(e)}return window.addEventListener("load",(function(){setTimeout((function(){n=!0,f("TDELAY -----"),u()}),5e3)}),!1),{addFile:function(e,i,n,s,a,d,h,f,u){var m=new l(e,i,n,s,a,d,h,u);!0===f?o[e]=m:r[e]=m,t[e]=m,c(m)},addDelayFile:function(e,i){var n=new l(e,i,!1,[],!1,!1,!0);n.isTimeDelay=!0,f(e+" ...  FILE! TDELAY"),r[e]=n,t[e]=n,c(n)},addFunc:function(e,n,s,l,d,h,f,u,m,p){!0===h&&(e=e+"_"+i++);var w=new a(e,n,s,l,d,f,u,p);!0===m?o[e]=w:r[e]=w,t[e]=w,c(w)},addDelayFunc:function(e,i,n){var o=new a(e,i,n,!1,[],!0,!0);o.isTimeDelay=!0,f(e+" ...  FUNCTION! TDELAY"),r[e]=o,t[e]=o,c(o)},items:t,processAll:u,setallowLoad:function(e){s=e},markLoaded:function(e){if(e&&0!==e.length){if(e in t){var i=t[e];!0===i.isComplete?f(i.name+" "+e+": error loaded duplicate"):(i.isComplete=!0,i.isInitialized=!0)}else t[e]=new d(e,!0);f("markLoaded dummyfile: "+t[e].name)}},logWhatsBlocked:function(){for(var e in t)!1!==t.hasOwnProperty(e)&&h(t[e])}}}();__ez.evt.add=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n()},__ez.evt.remove=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):delete e["on"+t]};__ez.script.add=function(e){var t=document.createElement("script");t.src=e,t.async=!0,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)};__ez.dot={};__ez.queue.addFile('/detroitchicago/boise.js', '/detroitchicago/boise.js?gcb=195-3&cb=5', true, [], true, false, true, false);__ez.queue.addFile('/parsonsmaize/abilene.js', '/parsonsmaize/abilene.js?gcb=195-3&cb=33', true, [], true, false, true, false);</script>
<script data-ezscrex="false" type="text/javascript" data-cfasync="false">window._ezaq = Object.assign({}, typeof window._ezaq !== "undefined" ? window._ezaq : {}, {"ad_cache_level":1,"domain_id":86609,"ezcache_level":0,"ezcache_skip_code":0,"has_bad_image":0,"has_bad_words":0,"is_sitespeed":0,"lt_cache_level":0,"response_size_orig":145510,"response_time_orig":702,"template_id":5,"url":"https://en.wikichip.org/wiki/mirc/identifiers/$encode","word_count":0,"worst_bad_word_level":0});__ez.queue.markLoaded('ezaqBaseReady');</script>
<script data-ezscrex="false" type="text/javascript" data-cfasync="false">var _ezaq = window._ezaq = Object.assign({}, typeof window._ezaq !== "undefined" ? window._ezaq : {}, {"ab_test_id":"mod283-c","ad_cache_level":1,"ad_lazyload_version":0,"ad_load_version":0,"city":"Ashburn","country":"US","days_since_last_visit":-1,"domain_id":86609,"domain_test_group":20230808,"engaged_time_visit":0,"ezcache_level":0,"ezcache_skip_code":0,"form_factor_id":1,"framework_id":1,"has_bad_image":0,"has_bad_words":0,"is_embed":false,"is_return_visitor":false,"is_sitespeed":0,"last_page_load":"","last_pageview_id":"","lt_cache_level":0,"metro_code":511,"page_ad_positions":"","page_view_count":0,"page_view_id":"46f913fc-fea7-4ce3-4546-e6d0a3dedbd2","position_selection_id":0,"postal_code":"20149","pv_event_count":0,"response_size_orig":145510,"response_time_orig":702,"serverid":"i-0c78cd68c572a2aa5","state":"VA","t_epoch":1717052491,"template_id":5,"time_on_site_visit":0,"url":"https://en.wikichip.org/wiki/mirc/identifiers/$encode","visit_uuid":"e0b48073-8610-46fb-716e-0ee8ddcec584","word_count":6227,"worst_bad_word_level":0});__ez.queue.markLoaded('ezaqReady');var _ezExtraQueries = "&ez_orig=1";</script>
<script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>__ez.queue.addFile('/parsonsmaize/mulvane.js', '/parsonsmaize/mulvane.js?gcb=195-3&cb=6', true, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('/parsonsmaize/olathe.js', '/parsonsmaize/olathe.js?gcb=195-3&cb=24', false, ['/parsonsmaize/abilene.js','/parsonsmaize/mulvane.js'], true, false, true, false);__ez.queue.addFile('/porpoiseant/et.js', '/porpoiseant/et.js?gcb=195-3&cb=3', false, [], true, false, true, false);!function(){var e=function(e,i,t){var o=[],n=null;return{Add:function(t,d){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(__ez.dot.isDefined(t)&&__ez.dot.isValid(d))if(n==t&&o.length>0&&o[o.length-1].data.length+d.length<=5)o[o.length-1].data=o[o.length-1].data.concat(__ez.dot.dataToStr(d));else{var _={type:e,domain_id:__ez.dot.getDID(),t_epoch:__ez.dot.getEpoch(0),data:__ez.dot.dataToStr(d)};_[i]=t,a&&a.hasOwnProperty("impression_id")&&a.hasOwnProperty("ad_unit")&&(_.impression_id=a.impression_id.toString(),_.unit=a.ad_unit),o.push(_),n=t}},Fire:function(){if(void 0===document.visibilityState||"prerender"!==document.visibilityState){if(__ez.dot.isDefined(o)&&o.length>0)for(;o.length>0;){var e=5;e>o.length&&(e=o.length);var i=o.splice(0,e),n=__ez.dot.getURL(t)+"?orig="+(!0===__ez.template.isOrig?1:0)+"&v="+btoa(JSON.stringify(i));__ez.dot.Fire(n)}o=[]}}}};__ez.vep=e("video","video_impression_id","/detroitchicago/grapefruit.gif"),__ez.vaep=e("video-ad","video_ad_impression_id","/porpoiseant/lemon.gif"),__ez.osvaep=e("outstream-video-ad","video_ad_impression_id","/porpoiseant/tangerine.gif")}();</script><script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>__ez.queue.addFile('/detroitchicago/wichita.js', '/detroitchicago/wichita.js?gcb=195-3&cb=12', false, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('/detroitchicago/raleigh.js', '/detroitchicago/raleigh.js?gcb=195-3&cb=7', false, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('/detroitchicago/vista.js', '/detroitchicago/vista.js?gcb=195-3&cb=6', false, ['/parsonsmaize/abilene.js'], true, false, true, false);</script><base href="https://en.wikichip.org/wiki/mirc/identifiers/$encode"/>

<title>$encode Identifier - mIRC - WikiChip</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"mirc/identifiers/$encode","wgTitle":"mirc/identifiers/$encode","wgCurRevisionId":101568,"wgRevisionId":101568,"wgArticleId":1269,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"mirc/identifiers/$encode","wgRelevantArticleId":1269,"wgRequestId":"e2125bc47d7dbcab8a13860a","wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"preview":true,"publish":true},"wgPageFormsAutocompleteValues":[],"wgPageFormsAutocompleteOnAllChars":false,"wgPageFormsFieldProperties":[],"wgPageFormsCargoFields":[],"wgPageFormsDependentFields":[],"wgPageFormsGridValues":[],"wgPageFormsGridParams":[],"wgPageFormsShowOnSelect":[],"wgPageFormsScriptPath":"/w/extensions/PageForms","edgValues":null,"wgPageFormsEDSettings":null,"wgHeaderTabsTabIndexes":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","ext.mirc":"ready","ext.smw.style":"ready","ext.smw.tooltip.styles":"ready","mediawiki.skinning.interface":"ready","mediawiki.skinning.content.externallinks":"ready","skins.WikiChip2":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1glvl31",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["ext.smw.style","mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=ext.mirc%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.WikiChip2&amp;only=styles&amp;skin=WikiChip2"/>
<link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=ext.smw.style%7Cext.smw.tooltip.styles&amp;only=styles&amp;skin=WikiChip2"/>
<script async="" src="/w/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=WikiChip2"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=WikiChip2"/>
<meta name="generator" content="MediaWiki 1.28.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="ExportRDF" type="application/rdf+xml" title="mirc/identifiers/$encode" href="/w/index.php?title=Special:ExportRDF/mirc/identifiers/$encode&amp;xmlmime=rdf"/>
<link rel="alternate" type="application/x-wiki" title="Edit" href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit"/>
<link rel="edit" title="Edit" href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit"/>
<link rel="shortcut icon" href="/w/resources/assets/wikichip.png"/>
<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="WikiChip (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://en.wikichip.org/w/api.php?action=rsd"/>
<meta name="twitter:site" content="@WikiChip"/>
<meta name="twitter:image" content="https://en.wikichip.org/w/resources/assets/og_wikichip_logo.png"/>
<meta property="og:image" content="https://en.wikichip.org/w/resources/assets/og_wikichip_logo.png"/>
<meta property="og:title" content="$encode Identifier - mIRC - WikiChip"/>
<meta name="twitter:card" content="summary"/>
<meta property="og:type" content="article"/>
<meta property="twitter:description" content="The $encode identifier allows you to encode literal text, or text in %vars or &amp;binvars. The $encode identifier uses either Uuencode or MIME or Base32 or Z85 to encode. Additionally, $encode is capable of utilizing Blowfish to encrypt the target before encoding using u/m/a/v encoding."/>
<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css?family=Josefin+Sans:400,700&amp;display=swap" rel="stylesheet"/>
<script type='text/javascript'>
var ezoTemplate = 'orig_site';
var ezouid = '1';
var ezoFormfactor = '1';
</script><script data-ezscrex="false" type='text/javascript'>
var soc_app_id = '0';
var did = 86609;
var ezdomain = 'wikichip.org';
var ezoicSearchable = 1;
</script>
<script data-ezscrex='false' data-pagespeed-no-defer data-cfasync='false'>function create_ezolpl() {
	var d = new Date();
	d.setTime(d.getTime() + 365 * 24 * 60 * 60 * 1000);
	var expires = "expires=" + d.toUTCString();
	__ez.ck.setByCat(
	  "ezux_lpl_86609",
	  new Date().getTime() +
		"|" +
		_ezaq.page_view_id +
		"|" +
		_ezaq.is_return_visitor +
		"; " +
		expires,
	  "understand_audiences",
	  false
	);
  }
  function attach_ezolpl() {
	if (document.readyState === "complete") {
	  create_ezolpl();
	  return;
	}
	window.addEventListener("load", create_ezolpl);
  }  

__ez.queue.addFunc("attach_ezolpl", "attach_ezolpl", null, false, ['/detroitchicago/boise.js'], true, false, false, false);
</script></head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-mirc_identifiers_encode rootpage-mirc skin-WikiChip2 action-view">
<div id="mw-wrapper">
<div class="mw-body" role="main">
<!-- wikichip-header START -->
<div id="wikichip-header">
            <div id="wikichip-header-logo">
                <a href="/wiki/WikiChip"><img src="//en.wikichip.org/w/resources/assets/wikichip_logo4.svg" width="200px"/></a><br/>
                <span id="tagline">Semiconductor &amp; Computer Engineering</span>
            </div>
	    <div id="wikichip-aheader">
		<!-- Ezoic - wikichip/global/header - top_of_page -->
		<div id="ezoic-pub-ad-placeholder-138">
                <script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <ins class="adsbygoogle" style="display:block;" data-ad-client="ca-pub-1951113009523412" data-ad-slot="1822985275" data-ad-format="auto"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
		</div>
		<!-- End Ezoic - wikichip/global/header - top_of_page -->
            </div>
</div>
<!-- wikichip-header END -->
<!-- wikichip-main-menu START -->
<ul id="wikichip-main-menu">
	<li class="btn">
        <a class="btnllnk"><i class="fa fa-home" aria-hidden="true"></i><span class="mob-collapse"> WikiChip <i class="fa fa-angle-down" aria-hidden="true"></i></span></a>
        <div class="collapse">
            <div>
                <span class="wikichip-main-menu-header">WikiChip</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5><a href="https://en.wikichip.org/wiki/WikiChip">WikiChip</a></h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/WikiChip">Home</a></li>
                                    <li><a href="/wiki/Special:Random?nocache=1" title="Load a random page [alt-shift-x]" accesskey="x">Random Article</a></li>
                                    <li><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [alt-shift-r]" accesskey="r">Recent Changes</a></li>
                                    <li><a href="/wiki/WikiChip:chip_feed">Chip Feed</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5><a href="https://fuse.wikichip.org/">The Fuse Coverage</a></h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://fuse.wikichip.org/">Recent News</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/isscc/">ISSCC</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/iedm/">IEDM</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/vlsi/">VLSI</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/hot-chips/">Hot Chips</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/supercomputing/">SuperComputing</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Social Media</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://twitter.com/WikiChip" rel="nofollow">Twitter</a></li>
                                    <li><a href="https://flipboard.com/@WikiChip" rel="nofollow">Flipboard</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <div>
                <span class="wikichip-main-menu-header">Popular</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>Companies</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/intel">Intel</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd">AMD</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/arm_holdings">ARM</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/qualcomm">Qualcomm</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Microarchitectures</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/skylake_(client)">Skylake (Client)</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/skylake_(server)">Skylake (Server)</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/microarchitectures/zen">Zen</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/coffee_lake">Coffee Lake</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/microarchitectures/zen_2">Zen 2</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5><a href="https://en.wikichip.org/wiki/technology_node">Technology Nodes</a></h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/14_nm_lithography_process">14 nm</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/10_nm_lithography_process">10 nm</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/7_nm_lithography_process">7 nm</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
	</li>
	<li class="btn">
        <a class="btnllnk">
            <i class="fa fa-architecture" aria-hidden="true"></i><span class="mob-collapse"> Architectures <i class="fa fa-angle-down" aria-hidden="true"></i></span></a>
        <div class="collapse">
            <div>
                <span class="wikichip-main-menu-header">Popular x86</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>Intel</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li>
                                        Client
                                        <ul>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/skylake_(client)">Skylake</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/kaby_lake">Kaby Lake</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/coffee_lake">Coffee Lake</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/ice_lake_(client)">Ice Lake</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Server
                                        <ul>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/skylake_(server)">Skylake</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/cascade_lake">Cascade Lake</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/cooper_lake">Cooper Lake</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/ice_lake_(server)">Ice Lake</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Big Cores
                                        <ul>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/sunny_cove">Sunny Cove</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/willow_cove">Willow Cove</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Small Cores
                                        <ul>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/goldmont">Goldmont</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/goldmont_plus">Goldmont Plus</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/tremont">Tremont</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/intel/microarchitectures/gracemont">Gracemont</a></li>
                                        </ul>
                                    </li>
                                </ul>
                        </li>
                        <li>
                                <h5>AMD</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/amd/microarchitectures/zen">Zen</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/microarchitectures/zen_+">Zen+</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/microarchitectures/zen_2">Zen 2</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/microarchitectures/zen_3">Zen 3</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <div>
                <span class="wikichip-main-menu-header">Popular ARM</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>ARM</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li>
                                        Server
                                        <ul>
                                            <li><a href="https://en.wikichip.org/wiki/arm_holdings/microarchitectures/neoverse n1">Neoverse N1</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/arm_holdings/microarchitectures/zeus">Zeus</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Big
                                        <ul><!--
                                            <li><a href="https://en.wikichip.org/wiki/arm_holdings/microarchitectures/cortex-a72">Cortex-A72</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/arm_holdings/microarchitectures/cortex-a73">Cortex-A73</a></li>-->
					    <li><a href="https://en.wikichip.org/wiki/arm_holdings/microarchitectures/cortex-a75">Cortex-A75</a></li>

                                            <li><a href="https://en.wikichip.org/wiki/arm_holdings/microarchitectures/cortex-a76">Cortex-A76</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/arm_holdings/microarchitectures/cortex-a77">Cortex-A77</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Little
                                        <ul>
                                            <li><a href="https://en.wikichip.org/wiki/arm_holdings/microarchitectures/cortex-a53">Cortex-A53</a></li>
                                            <li><a href="https://en.wikichip.org/wiki/arm_holdings/microarchitectures/cortex-a55">Cortex-A55</a></li>
                                        </ul>
                                    </li>
                                </ul>
                        </li>
                        <li>
                                <h5>Cavium</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/cavium/microarchitectures/vulcan">Vulcan</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Samsung</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/samsung/microarchitectures/m1">Exynos M1</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/samsung/microarchitectures/m2">Exynos M2</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/samsung/microarchitectures/m3">Exynos M3</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/samsung/microarchitectures/m4">Exynos M4</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </li>
	<li class="btn">
        <a class="btnllnk"><i class="fa fa-microchip" aria-hidden="true"></i><span class="mob-collapse"> Chips <i class="fa fa-angle-down" aria-hidden="true"></i></span></a>

        <div class="collapse">
            <div>
                <span class="wikichip-main-menu-header">Popular Families</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>Intel</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/intel/core_i3">Core i3</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/core_i5">Core i5</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/core_i7">Core i7</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/core_i9">Core i9</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/xeon_d">Xeon D</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/xeon_e">Xeon E</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/xeon_w">Xeon W</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/xeon_bronze">Xeon Bronze</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/xeon_silver">Xeon Silver</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/xeon_gold">Xeon Gold</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/intel/xeon_platinum">Xeon Platinum</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>AMD</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/amd/ryzen_3">Ryzen 3</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/ryzen_5">Ryzen 5</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/ryzen_7">Ryzen 7</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/ryzen_threadripper">Ryzen Threadripper</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/epyc">EPYC</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/amd/epyc_embedded">EPYC Embedded</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <div>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>Ampere</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/ampere_computing/emag">eMAG</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Apple</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/apple/ax">Ax</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Cavium</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/cavium/thunderx">ThunderX</a></li>
                                    <li><a href="https://en.wikichip.org/wiki/cavium/thunderx2">ThunderX2</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>HiSilicon</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/hisilicon/kirin">Kirin</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>MediaTek</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/mediatek/helio">Helio</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>NXP</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="">i.MX</a></li>
                                    <li><a href="">QorIQ Layerscape</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Qualcomm</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="">Snapdragon 400</a></li>
                                    <li><a href="">Snapdragon 600</a></li>
                                    <li><a href="">Snapdragon 700</a></li>
                                    <li><a href="">Snapdragon 800</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Renesas</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/renesas/r-car">R-Car</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Samsung</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://en.wikichip.org/wiki/samsung/exynos">Exynos</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
	</li>

	<li class="input-search">
                <form class="mw-portlet" role="search" action="/w/index.php" id="p-search">
                        <input type="hidden" value="Special:Search" name="title"/>
                        <input type="search" name="search" class="form-control" placeholder="chip, part #, µarch, family, etc" title="Search WikiChip [alt-shift-f]" accesskey="f" id="searchInput" autocomplete="off"/>
                        <button type="submit" name="go" title="Go to the page by that name or part # if it exists"><i class="fa fa-search" aria-hidden="true"></i></button>
</form>
	</li>
</ul>
<!-- wikichip-main-menu END -->
<!-- wikichip-body-container START -->
<div class="wikichip-body-container">
<!-- mw-body-content enclosure START -->
<div id="wikichip-body-content">
<!-- mw-body-content START -->
<div class="mw-body-content">
                                <div id="siteSub">From WikiChip</div>					
<div id="article-title">
<nav id="primary_nav_wrap">
<ul>
<li><a><span class="mob-collapse"><i class="fa fa-file-o" aria-hidden="true"></i></span></a><ul><li class="selected"><a href="/wiki/mirc/identifiers/$encode">Page</a></li></ul></li><li class=""><a href="/wiki/Talk:mirc/identifiers/$encode"><i class="fa fa-comments" aria-hidden="true"></i></a></li>

  <li class=""><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit" title="Edit this page [alt-shift-e]" accesskey="e"><i class="fa fa-edit" aria-hidden="true"></i></a></li><li class=""><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=history"><i class="fa fa-history" aria-hidden="true"></i></a></li>

            <li><a><i class="fa fa-user-circle-o" aria-hidden="true"></i></a><ul><li class="pt-anontalk pt-anontalk"><a href="/wiki/Special:MyTalk" title="Discussion about edits from this IP address [alt-shift-n]" accesskey="n"><i class="fa fa-users" aria-hidden="true"></i> Talk</a></li><li class="pt-anoncontribs pt-anoncontribs"><a href="/wiki/Special:MyContributions" title="A list of edits made from this IP address [alt-shift-y]" accesskey="y"><i class="fa fa-list" aria-hidden="true"></i> Contributions</a></li><li class="pt-login pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=mirc%2Fidentifiers%2F%24encode"><i class="fa fa-sign-in" aria-hidden="true"></i> Log in</a></li>		</ul>
	</li>



<li><a><i class="fa fa-cogs" aria-hidden="true"></i></a>
<ul>
<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/mirc/identifiers/$encode"><i class="fa fa-map" aria-hidden="true"></i> What links here</a></li><li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/mirc/identifiers/$encode"><i class="fa fa-list" aria-hidden="true"></i> Related changes</a></li><li id="t-print"><a href="/w/index.php?title=mirc/identifiers/$encode&amp;printable=yes"><i class="fa fa-file-text-o" aria-hidden="true"></i> Printable version</a></li><li id="t-permalink"><a href="/w/index.php?title=mirc/identifiers/$encode&amp;oldid=101568"><i class="fa fa-link" aria-hidden="true"></i> Permanent link</a></li><li id="t-info"><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=info"><i class="fa fa-info-circle" aria-hidden="true"></i> Page information</a></li><li id="t-smwbrowselink"><a href="/wiki/Special:Browse/:mirc-2Fidentifiers-2F-24encode"><i class="fa fa-tasks" aria-hidden="true"></i> Browse properties</a></li><li id="t-specialpages"><a href="/wiki/Special:SpecialPages"><i class="fa fa-certificate" aria-hidden="true"></i> Special Pages</a></li></ul>
</li>
<li><a><i class="fa fa-wheelchair" aria-hidden="true"></i></a>
  <ul>
    <li><a id="wikichip-dec-font"><img src="//en.wikichip.org/w/resources/assets/wikichip/a minus.svg" alt="Decrease Font Size" width="14"/> Decrease Size</a></li>
    <li><a id="wikichip-inc-font"><img src="//en.wikichip.org/w/resources/assets/wikichip/a plus.svg" alt="Increase Font Size" width="14"/> Increase Size</a></li>
    <li><a id="wikichip-std-font"><i class="fa fa-font" aria-hidden="true"></i> Normal Size</a></li>
  </ul>
</li>

</ul></nav>

    $encode Identifier - mIRC    <span id="article-indicator"><div class="mw-indicators">
</div>
</span>
</div>


                <div id="article-breadcrumbs">
                    <span class="pull-left"><span class="subpages">&lt; <a href="/wiki/mirc" title="mirc">mirc</a>‎ | <a href="/wiki/mirc/identifiers" title="mirc/identifiers">identifiers</a></span></span>
                </div>	
														<p></p><div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="guidebox">
<div style="text-align: center;"><a href="/wiki/mirc" title="mirc"><span style="color: rgba(0,0,0,.53); text-shadow: 0px 2px 3px rgba(0,0,0,.33); font-size: 20pt; font-weight: bold;">mIRC</span></a></div>
<div class="header">Commands &amp; Identifiers</div>
<ul><li> <a href="/wiki/mirc/commands" title="mirc/commands">mSL Commands</a></li>
<li> <a href="/wiki/mirc/identifiers" title="mirc/identifiers">mSL Identifiers</a></li></ul>
<div class="header">Basics</div>
<ul><li> <a href="/wiki/mirc/introduction" title="mirc/introduction">Introduction</a></li>
<li> <a href="/wiki/mirc/variables" title="mirc/variables">Variables</a></li>
<li> <a href="/wiki/mirc/string_manipulation" title="mirc/string manipulation">String Manipulation</a></li>
<li> <a href="/wiki/mirc/token_manipulation" title="mirc/token manipulation">Token Manipulation</a></li>
<li> <a href="/wiki/mirc/aliases" title="mirc/aliases">Aliases</a></li></ul>
<div class="header">Events</div>
<ul><li> <a href="/wiki/mirc/on_events" title="mirc/on events">On events</a></li>
<li> <a href="/wiki/mirc/access_levels" title="mirc/access levels">Access levels</a></li>
<li> <a href="/wiki/mirc/raw_events" title="mirc/raw events">Raw Events</a></li>
<li> <a href="/wiki/mirc/ctcp_events" title="mirc/ctcp events">Ctcp Events</a></li></ul>
<div class="header">Matching Tools</div>
<ul><li> <a href="/wiki/mirc/wildcard" title="mirc/wildcard">Wildcard</a></li>
<li> <a href="/wiki/mirc/regex" title="mirc/regex">Regex</a></li></ul>
<div class="header">Data Storage</div>
<ul><li> <a href="/wiki/mirc/variables" title="mirc/variables">Variables</a></li>
<li> <a href="/wiki/mirc/file_handling" title="mirc/file handling">File Handling</a></li>
<li> <a href="/wiki/mirc/hash_tables" title="mirc/hash tables">Hash Tables</a></li>
<li> <a href="/wiki/mirc/binary_variables" title="mirc/binary variables">Binary variables</a></li>
<li> <a href="/wiki/mirc/ini_files" title="mirc/ini files">INI Files</a></li>
<li> <a href="/wiki/mirc/text_files" title="mirc/text files">Text Files</a></li></ul>
<div class="header">Control Structures</div>
<ul><li> <a href="/wiki/mirc/conditional_statements" title="mirc/conditional statements">If Then Else</a></li>
<li> <a href="/wiki/mirc/operators" title="mirc/operators">Operators</a></li>
<li> <a href="/wiki/mirc/while_loops" title="mirc/while loops">While Loops</a></li>
<li> <a href="/wiki/mirc/goto_statements" title="mirc/goto statements">Goto Loops</a></li>
<li> <a href="/wiki/mirc/groups" title="mirc/groups">Groups</a></li></ul>
<div class="header">GUI Scripting</div>
<ul><li> <a href="/wiki/mirc/custom_windows" title="mirc/custom windows">Custom Windows</a></li>
<li> <a href="/wiki/mirc/picture_windows" title="mirc/picture windows">Picture Windows</a></li>
<li> <a href="/wiki/mirc/dialogs" title="mirc/dialogs">Dialogs</a></li>
<li> <a href="/wiki/mirc/dialog_components" title="mirc/dialog components">Dialog Components</a></li></ul>
<div class="header">Sockets</div>
<ul><li> <a href="/wiki/mirc/sockets" title="mirc/sockets">Sockets</a></li>
<li> <a href="/wiki/mirc/sockets/tcp" title="mirc/sockets/tcp">TCP Sockets</a></li>
<li> <a href="/wiki/mirc/sockets/udp" title="mirc/sockets/udp">UDP Sockets</a></li></ul>
<div class="header">Advanced Scripting</div>
<ul><li> <a href="/wiki/mirc/eval_brackets" class="mw-redirect" title="mirc/eval brackets">Eval Brackets</a></li>
<li> <a href="/wiki/mirc/com" class="mw-redirect" title="mirc/com">COM</a></li>
<li> <a href="/wiki/mirc/dll" class="mw-redirect" title="mirc/dll">DLL</a></li>
<li> <a href="/wiki/mirc/sendmessage" title="mirc/sendmessage">SendMessage</a></li></ul>
<div class="header">Additional Resources</div>
<ul><li> <a href="/wiki/mirc/commands" title="mirc/commands">mSL Commands</a></li>
<li> <a href="/wiki/mirc/identifiers" title="mirc/identifiers">mSL Identifiers</a></li>
<li> <a href="/wiki/mirc/local_identifiers" title="mirc/local identifiers">mSL Local Identifiers</a></li>
<li> <a href="/wiki/mirc/on_events" title="mirc/on events">mSL Events</a></li>
<li> <a href="/wiki/mirc/access_levels#Event_prefixes" title="mirc/access levels">mSL Event Prefixes</a></li></ul>
<div class="header">Security</div>
<ul><li> <a href="/wiki/mirc/msl_injection" title="mirc/msl injection">mSL Injection</a></li>
<li> <a href="/wiki/mirc/dcc_get_security" title="mirc/dcc get security">DCC GET security</a></li></ul>
<div class="header">Other</div>
<ul><li> <a href="/wiki/mirc/mirc_installation" title="mirc/mirc installation">mIRC Installation</a></li>
<li> <a href="/wiki/mirc/virtual_profile" title="mirc/virtual profile">Virtual profile</a></li>
<li> <a href="/wiki/mirc/playing_music" title="mirc/playing music">Playing music</a></li>
<li> <a href="/wiki/mirc/unicode" title="mirc/unicode">Unicode</a></li>
<li> <a href="/wiki/mirc/ipv6" title="mirc/ipv6">IPv6</a></li>
<li> <a href="/wiki/mirc/optimization" title="mirc/optimization">Optimization</a></li>
<li> <a href="/wiki/mirc/thread" title="mirc/thread">Threads</a></li>
<li> <a href="/wiki/mirc/dcc_protocols" title="mirc/dcc protocols">DCC Protocols</a></li>
<li> <a href="/w/index.php?title=mirc/line_length_limit&amp;action=edit&amp;redlink=1" class="new" title="mirc/line length limit (page does not exist)">Line Length Limit</a></li>
<li> <a href="/w/index.php?title=mirc/font_rendering&amp;action=edit&amp;redlink=1" class="new" title="mirc/font rendering (page does not exist)">Font rendering</a></li></ul>
<div></div><span class="noprint plainlinks navbar" style="float:right;"><small><span style="white-space:nowrap;word-spacing:-.12em;"><a href="/wiki/Template:mirc_guide" title="Template:mirc guide"><span style="" title="View this template">v</span></a><span style=""> <b>·</b> </span><a href="/wiki/Template:mirc_guide" title="Template:mirc guide"><span style="" title="Discuss this template">d</span></a><span style=""> <b>·</b> </span><a rel="nofollow" class="external text" href="https://en.wikichip.org/w/index.php?title=Template:mirc_guide&amp;action=edit"><span style="" title="Edit this template">e</span></a></span></small></span>
</div>
<p>The <b>$encode</b> identifier allows you to encode literal text, or text in <a href="/wiki/mirc/variables" title="mirc/variables">%vars</a> or <a href="/wiki/mirc/binary_variables" title="mirc/binary variables">&amp;binvars</a>. The <b>$encode</b> identifier uses either <a href="/w/index.php?title=Uuencode&amp;action=edit&amp;redlink=1" class="new" title="Uuencode (page does not exist)">Uuencode</a> or <a href="/w/index.php?title=Base64&amp;action=edit&amp;redlink=1" class="new" title="Base64 (page does not exist)">MIME</a> or Base32 or Z85 to encode. Additionally, $encode is capable of utilizing <a href="/w/index.php?title=Blowfish&amp;action=edit&amp;redlink=1" class="new" title="Blowfish (page does not exist)">Blowfish</a> to encrypt the target before encoding using u/m/a/v encoding.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Synopsis"><span class="tocnumber">1</span> <span class="toctext">Synopsis</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Parameters"><span class="tocnumber">2</span> <span class="toctext">Parameters</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Encoding"><span class="tocnumber">2.1</span> <span class="toctext">Encoding</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Encryption"><span class="tocnumber">2.2</span> <span class="toctext">Encryption</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Compatibility"><span class="tocnumber">4</span> <span class="toctext">Compatibility</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">5</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Synopsis">Synopsis</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit&amp;section=1" title="Edit section: Synopsis">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>; encoding only
$encode(text/%var/&amp;binvar [, btumav] [, N] )

; encryption
$encode(text/%var/&amp;binvar, celsirznpbtumav, key[, salt/iv if s|i used] [,N] )</pre>
<h2><span class="mw-headline" id="Parameters">Parameters</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit&amp;section=2" title="Edit section: Parameters">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Encoding">Encoding</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit&amp;section=3" title="Edit section: Encoding">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> text/%var/&amp;binvar </b></span>  The target to be encoded<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> b </b></span>  Target is a <a href="/wiki/mirc/binary_variables" title="mirc/binary variables">&amp;binvar</a><br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> t </b></span>  Target is text (this is default target type)<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> u </b></span>  Target should be encoded using <a href="/w/index.php?title=Uuencode&amp;action=edit&amp;redlink=1" class="new" title="Uuencode (page does not exist)">Uuencode</a> (this is default encode type when &#39;tuma&#39; not used)<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> m </b></span>  Target should be encoded using <a href="/w/index.php?title=Mime&amp;action=edit&amp;redlink=1" class="new" title="Mime (page does not exist)">Mime</a> (base64) (favored; has shortest output)<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> a </b></span>  Target should be encoded using Base32<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> v </b></span>  Target should be encoded using Z85<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> N </b></span>  Integer Reference index for the Nth chunk (can&#39;t use without at least 1 switch)
</p>
<ul><li> &#39;b&#39; recognizes target is a binary variable instead of text beginning with &#39;&amp;&#39;.</li>
<li> &#39;b&#39; returns encoded output back to the same binary variable, then the $encode identifier &#39;returns&#39; N where N is the new length of the &amp;binary variable. Most common usage would be to $encode as an argument to noop or conditional checking if non-zero to detect failure.</li>
<li> When target is text or %variable, content is UTF-8 encoded before encoding. To avoid this, you must load text into a binary variable using &#39;bset -ta&#39; then use $encode&#39;s &#39;b&#39; switch to allow using that binary variable as the target. (Assuming string does not contain codepoints 256+)</li>
<li> &#39;m&#39; mime/base64 and &#39;u&#39; UUencode encode 3 bytes into 4 printable characters, with u also prepending a length byte before each chunk of up to 60 encoded characters.</li>
<li> &#39;a&#39; Base32 encodes 5 bytes into 8 printable characters.</li>
<li> &#39;v&#39; Z85 variant of Base85 encodes 4 bytes into 5 printable characters.</li>
<li> If N parameter is present, N=0 returns the number of chunks in the output, N &gt;= 1 returns the Nth encoded chunk of the output or $null if N is greater than the N=0 value. N allows handling encoded output output of &amp;binary strings too long to fit within %variables or mIRC&#39;s maximum line length.</li>
<li> except for the final possibly partial length, N Chunks contain 60 encoding characters, except for base32 which contains 72, and except for &#39;u&#39; which inserts a length byte in front of each chunk. This feature was added prior to UTF8 support, so it&#39;s possible for this feature to split the encoding of UTF8 codepoints across 2 chunks.</li>
<li> $decode is currently able to decode mime/UUencode encoded strings without the &#34;`&#34; or &#34;=&#34; padding added by $encode, but don&#39;t count on pre-v7.53 or other applications accepting them for all cases for all encoding types.</li>
<li> This version of Base32 is different than the base32 used in $totp and $hotp. Base32 uses a 32-item alphabet consisting of upper-case A-Z and the numbers 2-7. However, in addition to accepting base32 as case-insensitive, $decode also accepts these invalid numbers the same as if valid characters were used: Number 1 as if the letter L, Number 8 as if the letter B.</li></ul>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> -s <span class="mirc_variable">%a</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>PWETA,a<span class="mirc_bracket">)</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%a</span>,a<span class="mirc_bracket">)</span> vs <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$replace" title="$replace - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$replace</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%a</span>,8,b,1,l<span class="mirc_bracket">)</span>,a<span class="mirc_bracket">)</span> vs <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$lower" title="$lower - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$lower</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%a<span class="mirc_bracket">)</span></span>,a<span class="mirc_bracket">)</span></span></pre>
<h3><span class="mw-headline" id="Encryption">Encryption</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit&amp;section=4" title="Edit section: Encryption">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> c </b></span>  CBC encryption mode defaults to using a mirc-generated pseudo-random binary salt. Adds 16-byte header inside u/m/a/v encoding: Salted__ $+ 8-byte-random-binary-salt.<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> e </b></span>  ECB encryption mode, &#39;sir&#39; switches become invalid.
Note: &#39;c&#39; is ignored if both of the conflicting c/e are used. Using &#39;c&#39; or &#39;e&#39; requires the key Parameter#3 be present. If the key is blank, instead of being an invalid parameter, it substitutes as if the user used a key consisting entirely of 0x00 bytes.<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> l </b></span>  Literal key parameter used as key. For &#39;c&#39; this avoids using an algorithm to hash the key parameter. For &#39;e&#39; this changes the key length limit from 72 down to 56 bytes. However $encode allows using &#39;cl&#39; but ignores it when you do not use &#39;s&#39;.<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> s </b></span>  user defined 8-byte salt instead of random. (valid only when &#39;c&#39; also used) When shorter than 8 bytes, is padded to 8 using 0x00 bytes. Same 16-byte header as non-s, except the 8-byte salt is the 1st 8 bytes of Parameter#4. Salt is interpreted in ANSI mode without encoding codepoints 128-255 to 2 bytes, and codepoint &gt;255 is an invalid parameter. Warning: $encode truncates a string longer than 8 instead of treating as an invalid parameter<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> r </b></span>  random IV (valid only when &#39;c&#39; also used. Adds 16-byte header inside u/m/a/v encoding: RandomIV $+ X... where X is the randomly generated literal IV.  When not using &#39;l&#39;, this uses a hash method that&#39;s much weaker than the algorithm used for salted keys.<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> i </b></span>  same as &#39;r&#39; except uses user-defined string provided in Parameter#4 using same string handling rules as used when that parameter is a SALT belonging to the &#39;s&#39; switch. If also used alongside &#39;r&#39;, the string placed inside the 16-byte header is the user-defined string instead of random. If &#39;r&#39; is not used, the exact same key/iv is used, except there is no 16-byte header inserted in front of the ciphertext. &#39;s&#39; and &#39;i&#39; should not be used together, as &#39;i&#39; causes &#39;s&#39; to be ignored.
Random IV/Salt created in the absence of Parameter#4 can contain 0x00 bytes in any position.<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> z </b></span>  1-8 0x00&#39;s padding ( no more than 1 of &#39;z n p&#39; should be used at the same time)<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> n </b></span>  padding 0x80 plus 0-7 0x00&#39;s<br/><span style="display: inline-block; min-width: 100px; {{#if | width: {{{width}}} | }}"><b> p </b></span>  1-8 0x20 spaces padding
</p><p>Notes:
</p>
<ul><li> Using the &#39;v&#39; Z85 encoding added in v7.73 has the advantage that it encodes the Blowfish binary into shorter strings than mime, due to encoding 4 binary as 5 text instead of encoding 3 binary as 4 text. For example, a ciphertext of 336 bytes which encodes as length 448 using &#39;m&#39; mime would encode as length 420 using &#39;v&#39; Z85, and would have a better chance of fitting within the fixed limit of an IRC message. However, because the Z85 alphabet contains characters such as $ % # etc, you must be careful to avoid using it in contexts where it could be double-evaluated in places such as a timer command string other other places described in <a href="/wiki/mirc/msl_injection" title="mirc/msl injection">msl_injection</a></li>
<li> &#39;N&#39; chunk parameter uses the same rules as non-encryption. It&#39;s an optional extra parameter past those required by the presence of other switches (&#39;ec&#39; require Parm3 &lt;key&gt;, &#39;c(s|i)&#39; also require Parm4 &lt;salt|iv&gt;)</li>
<li> &#39;e&#39; ECB mode is invalid syntax with switches &#39;s|i|r&#39;. In ECB mode, same key always encrypts identical groups of 8 plaintext bytes into the same 8 ciphertext bytes. Key is always literal UTF-8 &#39;key&#39; parameter of 0-72 bytes, except &#39;l&#39; switch limits literal ECB key to 56.</li>
<li> &#39;c&#39; default random salt allows same key to create different session-key:IV each time salt differs. If 8-byte random salt is randomly distributed across all 2^64 values, would require more than 2^32 messages before 50% probability of any 2 matching &#39;salt&#39; values.</li>
<li> Salt/IV parameter is silently truncated to 8 bytes, and uses 0x00 byte padding to length 8 if shorter. Parameter#4 is interpreted in ANSI mode, where ASCII 128-255 are not UTF-8 encoded into byte-pairs and codepoint &gt; 255 are invalid.</li></ul>
<ul><li> Blowfish &#39;c&#39; encryption by default has 16-byte header beneath the encoding: The 8-byte string Salted__ followed by 8 &#39;random&#39; bytes. If using the &#39;s&#39; switch, the 4th &#39;salt&#39; parameter is placed in the header instead of the &#39;random&#39; salt.</li>
<li> any of s|i|r disables default random salt, and s|i require presence of 4th Salt/IV parameter</li>
<li> &lt;without s|i|r&gt;  Header is: Salted__ $+ 8-random-bytes</li>
<li> &#39;s&#39;  changes header to: &#39;Salted__&#39; $+ Parameter-#4</li>
<li> &#39;r&#39;  changes header to: &#39;RandomIV&#39; $+ 8-random-bytes</li>
<li> &#39;ir&#39; changes header to: &#39;RandomIV&#39; $+ Parameter-#4 (Chopped to 8 bytes or padded with 0x00&#39;s to length 8)</li>
<li> &#39;i&#39;  without &#39;r&#39; means Parameter-#4 user defined IV is required, but is kept a secret without adding the 16-byte header to the encrypted string which reveals the IV.</li></ul>
<p>Note that older mIRC versions had different handling of various parameters which differ from the current improved handling. For example some older versions allowed Salt/IV parameter containing codepoints &gt; 255 then interpreted as $chr(63). Non-literal key strings are currently limited to 100+$maxlenm, but there were 3 other length limits in the past. Some past versions truncated the randomly generated salt if it contained any 0x00 bytes, but did not do the same for random IV&#39;s
</p><p>Note: &#39;i&#39; is the <b>only option</b> that does not <i>&#34;blow your cover,&#34;</i> as any of the other (s|r|ir|&lt;none&gt;) options above will positively identify that the message is Blowfish encrypted by placing a plain-text header (&#34;Salted__&#34; or &#34;RandomIV&#34;) at the beginning of the encoded digest, along with the Salt/IV that was used.  Using &#39;i&#39; will be the most popular choice for this reason.  You must provide a #4 parameter, but you can leave it empty for all 0x00&#39;s IV, or use a predictable changing IV like the current time, an incriminating nonce, or use it as a second 8-character secret password.<br/>
</p><p>maroon alternate note: &#39;ci&#39; cannot be the popular choice without a way for the decrypter to know the IV used when encrypting. You should not use a constant salt/IV of all 0x00&#39;s or any other value because their purpose is to be a unique string for each message encrypted using that key. You should not use the $ctime string as your salt/IV because $encode silently chops the 10-char string to length 8, causing all messages for a 100-seconds period to be encrypted using the same Salt/IV, which for identical plaintexts would &#39;blow your cover&#39;. Even if using the right-most 8 bytes of $ctime to avoid this, it still allows collisions with other users of a shared KEY also using $right($ctime,8) due to everyone using the same narrow group of salt/IV values which slowly shift together across time, and would require either including a &#39;blow your cover&#39; string in the encrypted string or require brute force guessing to find the correct value. Blowing your cover can include sending mime strings which always decode to a multiple of length 8. Solutions can be, as described in examples: Stripping the 1st 8 bytes of the header but leaving the random salt/iv and having the decryptor insert the text header before feeding to $decode. Also, &#39;blow your cover&#39; can include using a salt parm left in the encoded string which never contain the 0x00 byte, or worse if they are always simple alphanumeric text. You can minimize this issue by using the $randsalt alias for creating random Salt/IV parms if needing to communicate with the past versions which did not correctly handle random salts containing 0x00 bytes, or using the examples below which avoid storing the &#34;Salted__&#34; or &#34;RandomIV&#34; string in the header, but leave the other (hopefully) random Salt/IV parm generated by the &#39;c&#39; or &#39;cr&#39; switch combos. Also, &#39;ci&#39; should be avoided because $decode is designed to ignore the switch combo in certain rare cases.<br/>
</p><p>maroon conclusion: Popular choice should be:<br/>
1. Avoid using Blowfish function prior to v7.58, as it fixes several weaknesses and security vulnerabilities mentioned here. v7.72 also has a fix that should not affect people who do not use extremely long key parameter strings<br/>
2. Use either no-padding-switches or &#39;n&#39; to avoid false matching the original message as if padding.
3. If using v7.56+, use &#39;c&#39; without the &#39;s&#39; switch to have a random salt. If worried about the &#39;Salted__&#34; header, you can script the removal/reinstatement of the header as in example below.<br/>
4. If using &lt;= v7.55, use &#39;c&#39; WITH the &#39;s&#39; switch, but use the $randsalt alias to define a random salt string which cannot contain embedded 0x00&#39;s. This avoids a bug where embedded 0x00 bytes in the Salt causes many unique salt strings to generate identical salted keys. Be sure to avoid non-literal keys longer than 56 bytes in v7.52-7.55, as bytes 57+ are silently ignored. Later versions silently ignored key parameter strings longer than 612 bytes, <br/>
5. Always avoid using &#39;r&#39; and/or &#39;i&#39; switches without the &#39;l&#39; switch, because the method used to hash the key parameter lowers the strength of the key parameter down to &#39;only&#39; 128 bits. Even a literal key of 56 hex digits with the &#39;l&#39; switch would&#39;ve had 2^224 possible combos.<br/>
6. Avoid using the &#39;ci&#39; without &#39;r&#39; switch combo. The broken design for $decode can cause a GPF crash in versions 7.57+earlier, or incorrect decryption in v7.58+.
</p><p>Padding of 8-byte blocks with 1-8 bytes of padding ensures encryption sees binary message length as exact multiple of 8. Padding is added by $encode depending which of the &#39;n|p|z|none&#39; padding switches are used.<br/>
</p>
<ul><li> default: if &#39;npz&#39; not specified, PKCS#7 padding = appends 1-8 of $chr(N) where N is the number of bytes to be padded. ie: padding length 1 = $chr(1), 2 = 2x $chr(2)&#39;s, ..., 8 = 8x $chr(8)&#39;s</li>
<li> &#39;n&#39; Bit Padding = Appends $chr(128) character followed by 0-7 0x00&#39;s</li>
<li> &#39;p&#39; Appends 1-8 $chr(32) spaces</li>
<li> &#39;z&#39; Appends 1-8 0x00 nulls</li>
<li> Due to the broken by-design behavior of $decode, the &#39;z&#39; padding switch should NOT be used, even for text messages which cannot contain the 0x00&#39;s appended by &#39;z&#39; padding. Instead of removing the indicated type of padding, $decode ignores any padding switches used, and instead searches for all 4 supported types of padding. The attempt to match &#39;z&#39; padding has a false match with &#39;n&#39; padding if the plaintext ends with the 0x80 byte and the length of the plaintext is not already a length that&#39;s a multiple of 8, as happens for <b>ALL</b> unicode codepoints 128+ which are a multiple of 64. You cannot reliably detect use of bad keys by checking the length of the decrypted string, because decrypting with the wrong password has a 4/256 chance of false matching padding due to matching at minimum final byte values being any of the 4: 0x00 0x20 0x01 0x80. Example of the final character of the text message being destroyed by using &#39;z&#39; padding:</li></ul>
<p>//bset -t &amp;v 8 0 | while (8 // $bvar(&amp;v,0)) { bset -tc &amp;v 1 $str(.,$r(1,7)) $+ $chr($calc(64*$rand(3,800))) } | echo -a original: = $bvar(&amp;v,1-) displays as: $bvar(&amp;v,1-).text | noop $encode(&amp;v,bmcz,key) $decode(&amp;v,bmcz,key) | echo 4 -a decrypted = $bvar(&amp;v,1-) displays.... as: $bvar(&amp;v,1-).text
</p><p>&#39;p&#39; padding is OK to use with text messages where removing 1-7 extra trailing spaces is harmless. But due to the broken $decode handling of padding, you should avoid using &#39;z&#39; padding, and is best to use only the &#39;n&#39; switch or PKCS#7 from no-padding-switch used.
</p><p>If possible, use mIRC version v7.58+ which fixes most of the security/design issues with $encode. Starting with v7.56:<br/>
1. &#39;c&#39; used without &#39;l&#39; switch for non-literal keys no longer silently chops hashed key parameter to 56 bytes, and instead silently chopped at 612<br/>
2. &#39;i&#39; and &#39;s&#39; switches no longer permit Parm#4 Salt/IV strings containing codepoint 256+ which formerly were each silently replaced with the same codepoint 63.<br/>
3. Salts are now treated as 8-byte binary strings the same as IV are, instead of being truncated at the first 0x00 byte, which happens with the 3% of 8-byte random strings where at least 1 bytes is 0x00. This formerly resulted in a significant portion of unique random salts being treated as if identical. i.e. 1/256 of all random salts began with 0x00, and were all treated as identical $null salt.<br/>
Remaining security issues your script needs to avoid:<br/>
1. $encode/$decode accept invalid $null key parameter, so you must either verify if %key is $null, or use $$+(%key) to halt it if it&#39;s $null<br/>
2. $encode accepts invalid &#39;s|i&#39; parameters longer than 8 bytes, then silently chops them to the valid length 8 bytes.<br/>
3. $decode&#39;s by-design ignoring padding switches and instead searching for match with 4 types of padding means you should avoid using &#39;z&#39; padding when there&#39;s a possibility that the final UTF8-encoded byte of the message is 0x80, so you should either use &#39;n&#39; or no-padding-switch.<br/>
</p><p>Incompatibilities between v7.56+ and earlier versions due to fixing bugs causing incorrect encryption/decryption in older versions. Possible workarounds are explained in more detail at <a rel="nofollow" class="external free" href="https://forums.mirc.com/ubbthreads.php/topics/265396/re-invalid-key-lengths-in-encode-data-lt-e-l-cl-gt-key#Post265396">https://forums.mirc.com/ubbthreads.php/topics/265396/re-invalid-key-lengths-in-encode-data-lt-e-l-cl-gt-key#Post265396</a><br/>
1. For the approx 3.1% of random 64-bit salt strings which contain at least 1 0x00 byte, the incompatible salt string handling can make it difficult to manipulate old messages so they can be decoded in new mIRC, but is generally impossible for older mIRC&#39;s to decode those 3.1% of messages created in newer mIRC.<br/>
2. For older messages created where byte values 57+ of the key parameter are ignored, v7.56+ can use $left(key parameter,56) to decode them, as long as the 56-byte string does not end with a partial UTF-8 character encoding.<br/>
3. For older messages created using &#39;s|i&#39; parameters containing codepoints 256+, these were encrypted using the &#39;?&#39; character instead, so v7.56+ can simply use the &#39;?&#39; in all salt|IV parameters which formerly included those characters, which are now invalid.<br/>
4. Using &#39;ci&#39; without &#39;r&#39; should not be used because of the 2 cases per 4 billion where decrypted messages are either missing the first 16 decoded bytes or the output is garbled. This is due to $decode incorrectly ignoring the &#39;ci&#39; switches used if the data happens to be encrypted into ciphertext beginning with the binary bytes happening to form the magic RandomIV or Salted__ strings. If you do use this switch combo, you should check check if the encrypted mime string begins with either UmFuZG9tSV or U2FsdGVkX1, and if so you should place the encrypted string into a binary variable then use ONLY the the &#39;m&#39; switch to test if the ciphertext begins with either of the 2 magic strings.
</p><p>The strongest known attack against Blowfish is the SWEET32 attack against the 64-bit block size. You can mitigate this problem by avoiding the encryption of hundreds of megabytes of data using the same encryption key, because SWEET32 is looking only for massive amounts of ciphertext using the identical binary key. A random+unique salt is enough to defend against this attack, since each message then uses a different encryption key. Note the SWEET32 attack works against using the identical encryption key with a random literal IV created from the &#39;r&#39; and/or &#39;i&#39; switches, and cannot be defended against by using a longer encryption key. This means that when using $encode&#39;s encryption, you should use a randomly changing salt, without using the &#39;i|r&#39; switches. Even if the salt being used is a sequential counter which is predictable and could be duplicated between users in a small number of messages, the fact that the salt+key_parameter combo is identical in only a very small number of 8-byte blocks means the SWEET32 method has very little data to work with, and as long as users avoid using the same sequence again, that salt will not be repeated where the SWEET32 attacker could use it. Because $right($ticks,8) can repeat against your past messages prior to reboot, it should not be used. $right($ctime,8) should be enough to avoid repeating your own SALT2 as long as the key_parameter is changed prior to that value repeating every 3.1 years. However this still has the problem of frequently matching a salt by another user sharing the same key<br/>
</p>
<h2><span class="mw-headline" id="Examples">Examples</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit&amp;section=5" title="Edit section: Examples">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Echo to the active screen the following encode text, using Mime (base64) encoding:
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">//echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>Hello there! This will be encoded using Mime.,m<span class="mirc_bracket">)</span></span></pre>
<p>Mime encodes 3 input bytes as 4 output text characters using a 64-item alphabet, padded with &#39;=&#39; to a length that&#39;s a multiple of 4.
</p>
<pre><span class="code_line">The &#39;N&#39; parameter is ignored by <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a>, but is used to encode individual chunks of long binary variables, potentially chopping UTF8 encoding characters across separate chunks. When &#39;N&#39; is 0, returns the number of chunks in the input string, otherwise for N &gt;= 1 it encodes the Nth group of 45 bytes in the input string. Note how this example splits the encoding, resulting in chunk 1 ending with the alt+195 byte and the chunk 2 begins with the alt+169 byte:</span>
<span class="code_line"> </span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> -s <span class="mirc_variable">%a</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>233<span class="mirc_bracket">)</span>,100<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> , <span class="mirc_variable">%b</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%a</span>,m,1<span class="mirc_bracket">)</span> , <span class="mirc_variable">%c</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%a</span>,m,2<span class="mirc_bracket">)</span> , <span class="mirc_variable">%d</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%b</span>,m<span class="mirc_bracket">)</span> vs <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%c</span>,m<span class="mirc_bracket">)</span></span></pre>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a> encrypts the string then applies u/m/a coding to change binary encrypted data to text.</span>
<span class="code_line">Decoding with matching u/m/a without using e|c displays the header and cipher binary hidden beneath <span class="mirc_bracket">(</span>some strings can be truncated when 0x00 are encountered in decoded mime string<span class="mirc_bracket">)</span>:</span>
<span class="code_line"> </span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> <span class="mirc_variable">%a</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>text,csm,key,ParmSalt<span class="mirc_bracket">)</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a <span class="mirc_variable">%a</span> -&gt; <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%a</span>,m<span class="mirc_bracket">)</span></span></pre>
<pre><span class="code_line"><span class="mirc_comment">/*</span></span>
<span class="code_line"><span class="mirc_comment">These are 2 methods of encrypting channel messages where everyone in a channel uses the same shared password. They intentionally does not support &#39;/me action&#39; or /query windows, and handle only 1-word messages of length 25+. To defend against different users unknowingly using the same salt, the messages include the sender&#39;s nick as part of the key, which causes the same salt to NOT generate the same encryption key. Message is encrypted using a random salt, but the &#39;Salted__&#39; header is removed from the mimed string before sent to channel, then added to message before decryption. Add &#39;g&#39; switch to echoes to avoid them being logged.</span></span>
<span class="code_line"><span class="mirc_comment">*/</span></span>
<span class="code_line"><span class="mirc_control">ON</span> *:<span class="mirc_control">TEXT</span>:=*:##maroon,#channelname: <span class="mirc_bracket">{</span> <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a> != <a href="http://en.wikichip.org/wiki/mirc/identifiers/$null" title="$null - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$null</span></a><span class="mirc_bracket">)</span> || <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$len" title="$len - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$len</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a><span class="mirc_bracket">)</span> &lt; 25<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> <span class="mirc_control">return</span> | fake_secret_chat <a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a> <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_control">ON</span> &amp;*:<span class="mirc_control">INPUT</span>:##maroon,#channelname:<span class="mirc_bracket">{</span> <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><span class="mirc_bracket">(</span>/* iswm <a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a><span class="mirc_bracket">)</span> || <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$ctrlenter" title="$ctrlenter - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$ctrlenter</span></a><span class="mirc_bracket">)</span> || <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$inpaste" title="$inpaste - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$inpaste</span></a><span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> <span class="mirc_control">return</span> | fake_secret_chat <a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>- <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_control">ON</span> *:<span class="mirc_control">CONNECT</span>:<span class="mirc_bracket">{</span> <span class="mirc_control">if</span> <span class="mirc_bracket">(</span>!<a href="http://en.wikichip.org/wiki/mirc/identifiers/$hget" title="$hget - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$hget</span></a><span class="mirc_bracket">(</span>secret_chat<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span><a href="http://en.wikichip.org/wiki/mirc/commands/hload" title="/hload - mIRC Command" style="text-decoration: none"><span class="mirc_command"> hload</span></a> secret_chat secret_chat.txt <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_control">ON</span> *:<span class="mirc_control">EXIT</span>:<span class="mirc_bracket">{</span>    <span class="mirc_control">if</span> <span class="mirc_bracket">(</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$hget" title="$hget - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$hget</span></a><span class="mirc_bracket">(</span>secret_chat<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span><a href="http://en.wikichip.org/wiki/mirc/commands/hsave" title="/hsave - mIRC Command" style="text-decoration: none"><span class="mirc_command"> hsave</span></a> secret_chat secret_chat.txt <span class="mirc_bracket">}</span></span>
<span class="code_line"> </span>
<span class="code_line"><span class="mirc_comment">; remove the number from either alias name ending with chat1 or chat2</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/aliases" title="Aliases - mIRC" style="text-decoration: none;"><span class="mirc_control">alias</span></a> <em>fake_secret_chat1</em> <span class="mirc_bracket"><span class="mirc_bracket">{</span></span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span>!<a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a><span class="mirc_bracket">)</span> <span class="mirc_control">return</span></span>
<span class="code_line"><span class="mirc_comment">  ; //hadd -m secret_chat <a href="http://en.wikichip.org/wiki/mirc/identifiers/$network" title="$network - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$network</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> ##maroon Change this Shared Secret</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">  var</span></a> <span class="mirc_variable">%main_key</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$hget" title="$hget - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$hget</span></a><span class="mirc_bracket">(</span>secret_chat,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$network" title="$network - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$network</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a><span class="mirc_bracket">)</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><span class="mirc_variable">%main_key</span> == <a href="http://en.wikichip.org/wiki/mirc/identifiers/$null" title="$null - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$null</span></a><span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -g <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a> Note: Secret_Chat halted due to missing password! add password: /hadd -m secret_chat <a href="http://en.wikichip.org/wiki/mirc/identifiers/$network" title="$network - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$network</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a> Password goes here | <span class="mirc_control">return</span> <span class="mirc_bracket">}</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$event" title="$event - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$event</span></a> == input<span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/bset" title="/bset - mIRC Command" style="text-decoration: none"><span class="mirc_command">    bset</span></a> -tc &amp;secret_chat_msg 1 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>-,mc,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$me" title="$me - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$me</span></a> <span class="mirc_variable">%main_key<span class="mirc_bracket">)</span></span> |<a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command"> noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_msg,bm<span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/bcopy" title="/bcopy - mIRC Command" style="text-decoration: none"><span class="mirc_command">    bcopy</span></a> -c &amp;secret_chat_msg 1 &amp;secret_chat_msg 9 -1 |<a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command"> noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_msg,bm<span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/msg" title="/msg - mIRC Command" style="text-decoration: none"><span class="mirc_command">    msg</span></a> # = <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_msg,1-<span class="mirc_bracket">)</span>.text |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> 3 -tc own # Channel sees Encryption of: <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a><span class="mirc_bracket">(</span>&lt;,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a>,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$me" title="$me - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$me</span></a><span class="mirc_bracket">)</span>.pnick,&gt;<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>-</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/halt" title="/halt - mIRC Command" style="text-decoration: none"><span class="mirc_command">    halt</span></a></span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line">  <span class="mirc_control">else</span> <span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/bset" title="/bset - mIRC Command" style="text-decoration: none"><span class="mirc_command">    bset</span></a> -tc &amp;secret_chat_msg 1 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$mid" title="$mid - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$mid</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>,2<span class="mirc_bracket">)</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command"> noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_msg,bm<span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/bcopy" title="/bcopy - mIRC Command" style="text-decoration: none"><span class="mirc_command">    bcopy</span></a> &amp;secret_chat_msg 9 &amp;secret_chat_msg 1 -1</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/bset" title="/bset - mIRC Command" style="text-decoration: none"><span class="mirc_command">    bset</span></a> -t &amp;secret_chat_msg 1 Salted__ |<a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command"> noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_msg,bm<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_msg,bmc,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> <span class="mirc_variable">%main_key<span class="mirc_bracket">)</span></span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">    echo</span></a> -tcl normal # Decoded <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a><span class="mirc_bracket">(</span>&lt;,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a>,&gt;,:<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_msg,1-<span class="mirc_bracket">)</span>.text</span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span>
<span class="code_line"> </span>
<span class="code_line"><span class="mirc_comment">/*</span></span>
<span class="code_line"><span class="mirc_comment">This is a more complicated channel encryption, which includes a shared salt contained in the #channel topic, allowing the same shared password to behave similar to an unrelated password each time the #topic salt changes. This uses a superior method to hash the key parameter without using MD5. Each message generates a new 9-byte string where each byte can be values 0-255, and the 12-byte mime-encoding of this string is included in the message sent to the channel, instead of the actual IV or Salt used to encrypt the message. This mime-string + sender&#39;s nick + topic salt + main password are hashed with SHA-512 to create a 64-byte secret string which is split into a 56-byte literal key parameter and an 8-byte salt parameter. Since text salt parameters are truncated if they contain embedded 0x00 bytes, the 9-byte message salt is changed to avoid strings where the 1st 7 bytes contain the 0x00 byte. The attacker cannot know either the key parameter or the IV without also knowing the %main_key for that channel. Assuming the 9-byte string is generated randomly, the only way to identify which of the 2 aliases was used to encrypt the message is whether the mimed string&#39;s length is 8N or 8N+1.</span></span>
<span class="code_line"><span class="mirc_comment">*/</span></span>
<span class="code_line"> </span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/aliases" title="Aliases - mIRC" style="text-decoration: none;"><span class="mirc_control">alias</span></a> <em>fake_secret_chat2</em> <span class="mirc_bracket"><span class="mirc_bracket">{</span></span> <span class="mirc_control">if</span> <span class="mirc_bracket">(</span>!<a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a><span class="mirc_bracket">)</span> <span class="mirc_control">return</span></span>
<span class="code_line"><span class="mirc_comment">  ; //hadd -m secret_chat <a href="http://en.wikichip.org/wiki/mirc/identifiers/$network" title="$network - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$network</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> ##maroon Change this Shared Secret</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command">  noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regex" title="$regex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regex</span></a><span class="mirc_bracket">(</span>foo,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a><span class="mirc_bracket">)</span>.topic,salt:<span class="mirc_bracket">(</span>\S+<span class="mirc_bracket">)</span> <span class="mirc_bracket">)</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command"> var</span></a> <span class="mirc_variable">%chan.salt</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regml" title="$regml - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regml</span></a><span class="mirc_bracket">(</span>foo,1<span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">  var</span></a> <span class="mirc_variable">%main_key</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$hget" title="$hget - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$hget</span></a><span class="mirc_bracket">(</span>secret_chat,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$network" title="$network - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$network</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a><span class="mirc_bracket">)</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><span class="mirc_variable">%main_key</span> == <a href="http://en.wikichip.org/wiki/mirc/identifiers/$null" title="$null - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$null</span></a><span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -g <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a> Note: Secret_Chat halted due to missing password! add password: /hadd -m secret_chat <a href="http://en.wikichip.org/wiki/mirc/identifiers/$network" title="$network - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$network</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a> Password goes here | <span class="mirc_control">return</span> <span class="mirc_bracket">}</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$event" title="$event - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$event</span></a> == input<span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span></span>
<span class="code_line">    :make_another_salt</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/bset" title="/bset - mIRC Command" style="text-decoration: none"><span class="mirc_command">    bset</span></a> -c &amp;secret_chat_salt 1 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span>foo,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>x,9<span class="mirc_bracket">)</span>,/x/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a><span class="mirc_bracket">(</span>0,255<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>32<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command">    noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_salt,bm<span class="mirc_bracket">)</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command"> var</span></a> <span class="mirc_variable">%msg.salt</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_salt,1-<span class="mirc_bracket">)</span>.text</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/bset" title="/bset - mIRC Command" style="text-decoration: none"><span class="mirc_command">    bset</span></a> -c &amp;secret_chat_digest 1 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span>foo,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$sha512" title="$sha512 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$sha512</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%msg.salt</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$me" title="$me - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$me</span></a> <span class="mirc_variable">%chan.salt</span> <span class="mirc_variable">%main_key</span> <span class="mirc_variable">%chan.salt<span class="mirc_bracket">)</span></span>,/<span class="mirc_bracket">(</span>..<span class="mirc_bracket">)</span>/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$base" title="$base - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$base</span></a><span class="mirc_bracket">(</span>\t,16,10<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>32<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span>
<span class="code_line">    <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$istok" title="$istok - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$istok</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_digest,1-7<span class="mirc_bracket">)</span>,0,32<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span><a href="http://en.wikichip.org/wiki/mirc/commands/goto" title="/goto - mIRC Command" style="text-decoration: none"><span class="mirc_command"> goto</span></a> make_another_salt</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">    var</span></a> -p <span class="mirc_variable">%iv</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span>foo,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_digest,1-8<span class="mirc_bracket">)</span>,/<span class="mirc_bracket">(</span>\d+<span class="mirc_bracket">)</span>\s?/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>\t<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command">    noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_digest,bm<span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">    var</span></a> <span class="mirc_variable">%session_key</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_digest,12,56<span class="mirc_bracket">)</span>.text , <span class="mirc_variable">%text</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>-,mcli,<span class="mirc_variable">%session_key</span>,<span class="mirc_variable">%iv<span class="mirc_bracket">)</span></span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">    var</span></a> <span class="mirc_variable">%msg</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a><span class="mirc_bracket">(</span>=,<span class="mirc_variable">%msg.salt</span>,<span class="mirc_variable">%text<span class="mirc_bracket">)</span></span> |<a href="http://en.wikichip.org/wiki/mirc/commands/msg" title="/msg - mIRC Command" style="text-decoration: none"><span class="mirc_command"> msg</span></a> # <span class="mirc_variable">%msg</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> 3 -tc own # Channel sees Encryption of: <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a><span class="mirc_bracket">(</span>&lt;,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a>,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$me" title="$me - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$me</span></a><span class="mirc_bracket">)</span>.pnick,&gt;<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>-</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/halt" title="/halt - mIRC Command" style="text-decoration: none"><span class="mirc_command">    halt</span></a></span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line">  <span class="mirc_control">else</span> <span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/bset" title="/bset - mIRC Command" style="text-decoration: none"><span class="mirc_command">    bset</span></a> -c &amp;secret_chat_digest 1 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span>foo,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$sha512" title="$sha512 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$sha512</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$mid" title="$mid - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$mid</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>,2,12<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> <span class="mirc_variable">%chan.salt</span> <span class="mirc_variable">%main_key</span> <span class="mirc_variable">%chan.salt<span class="mirc_bracket">)</span></span>,/<span class="mirc_bracket">(</span>..<span class="mirc_bracket">)</span>/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$base" title="$base - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$base</span></a><span class="mirc_bracket">(</span>\t,16,10<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>32<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">    var</span></a> -p <span class="mirc_variable">%iv</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span>foo,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_digest,1-8<span class="mirc_bracket">)</span>,/<span class="mirc_bracket">(</span>\d+<span class="mirc_bracket">)</span>\s?/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>\t<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command">    noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_digest,bm<span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">    var</span></a> <span class="mirc_variable">%session_key</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;secret_chat_digest,12,56<span class="mirc_bracket">)</span>.text , <span class="mirc_variable">%text</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$mid" title="$mid - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$mid</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>,14<span class="mirc_bracket">)</span>,mcli,<span class="mirc_variable">%session_key</span>,<span class="mirc_variable">%iv<span class="mirc_bracket">)</span></span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">    echo</span></a> -tc normal # Decoded <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a><span class="mirc_bracket">(</span>&lt;,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a>,&gt;,:<span class="mirc_bracket">)</span> <span class="mirc_variable">%text</span></span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<p>If using pre-v7.56 random salt, or if using &#39;ir|s&#39; switches to create user-defined Salt&#39;s or IV&#39;s, you SHOULD use the $randsalt alias to salt strings from the entire valid text range of codepoints 1-255. This increases the possible combinations to as high as 255^8, which is the 96.9% of valid 8-byte strings which don&#39;t contain the 0x00 byte. This makes it much less likely where the birthday paradox produces messages with identical salt/iv&#39;s.
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/aliases" title="Aliases - mIRC" style="text-decoration: none;"><span class="mirc_control">alias</span></a> <em>randsalt</em> <span class="mirc_control">returnex</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>x,8<span class="mirc_bracket">)</span>,/x/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$rands" title="$rands - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rands</span></a><span class="mirc_bracket">(</span>1,255<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/aliases" title="Aliases - mIRC" style="text-decoration: none;"><span class="mirc_control">alias</span></a> <em>randsalt</em> <span class="mirc_control">returnex</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>x,8<span class="mirc_bracket">)</span>,/x/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a><span class="mirc_bracket">(</span> 1,255<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/aliases" title="Aliases - mIRC" style="text-decoration: none;"><span class="mirc_control">alias</span></a> <em>randsalt</em> <span class="mirc_bracket"><span class="mirc_bracket">{</span></span></span>
<span class="code_line">:retry |<a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command"> var</span></a> <span class="mirc_variable">%a</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span>foo,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>x,8<span class="mirc_bracket">)</span>,/x/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$rands" title="$rands - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rands</span></a><span class="mirc_bracket">(</span>0,255<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>32<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> , <span class="mirc_variable">%i</span> 1 , <span class="mirc_variable">%j</span> 2</span>
<span class="code_line"><span class="mirc_control">while</span> <span class="mirc_bracket">(</span><span class="mirc_variable">%i</span> isnum 1-7<span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span> <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$gettok" title="$gettok - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$gettok</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%a</span>,<span class="mirc_variable">%i</span>,32<span class="mirc_bracket">)</span> == 0<span class="mirc_bracket">)</span> &amp;&amp; <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$gettok" title="$gettok - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$gettok</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%a</span>,<span class="mirc_variable">%j</span>,32<span class="mirc_bracket">)</span> &gt; 0<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span><a href="http://en.wikichip.org/wiki/mirc/commands/goto" title="/goto - mIRC Command" style="text-decoration: none"><span class="mirc_command"> goto</span></a> retry |<a href="http://en.wikichip.org/wiki/mirc/commands/inc" title="/inc - mIRC Command" style="text-decoration: none"><span class="mirc_command"> inc</span></a> <span class="mirc_variable">%i</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/inc" title="/inc - mIRC Command" style="text-decoration: none"><span class="mirc_command"> inc</span></a> <span class="mirc_variable">%j</span> <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_control">return</span>ex <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span>foo,<span class="mirc_variable">%a</span>,/<span class="mirc_bracket">(</span>\d+<span class="mirc_bracket">)</span>\s*/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>\t<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_bracket">(</span>1st variant uses <a href="http://en.wikichip.org/wiki/mirc/identifiers/$rands" title="$rands - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rands</span></a>, 2nd uses <a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a>, 3rd allows salt to contain 0x00 if not preceding byte values 1-255<span class="mirc_bracket">)</span></span></pre>
<ul><li> Note: Because &#39;r&#39; switch is CBC mode without authentication, the decrypted message is vulnerable to trace-less bit-flipping of the 1st 8 bytes of the message into anything the attacker wishes by simply manipulating the IV and knowing the exact contents of the 1st 8 bytes of the plaintext message. The attacker does not need to know the key, nor even need to see how the message has been encrypted. This is <b>not</b> a Blowfish weakness, as the same thing would happen with AES where the larger blocksize would expose 16 bytes instead of 8. As an example, use any message where the 1st 8 bytes are all alpha characters and which do NOT contain a space character. Then encrypt with any lower-case text salt, and decrypt with the upper-case equivalent. This results in the decrypted message having the upper/lower case of each text character flipped, but the remainder of the message is NOT affected:</li></ul>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> -s <span class="mirc_variable">%iv</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$regsubex" title="$regsubex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regsubex</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>x,8<span class="mirc_bracket">)</span>,/x/g,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a><span class="mirc_bracket">(</span>a,z<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> , <span class="mirc_variable">%msg</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>BitFlipping Example,mci,key,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$upper" title="$upper - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$upper</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%iv<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span> |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%msg</span>,mci,key,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$lower" title="$lower - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$lower</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%iv<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span></span>
<span class="code_line">result: bITfLIPPing Example</span></pre>
<p>Solution: If worried about this, you should avoid using the &#39;i&#39; and/or &#39;r&#39; switches, and always use either a random or user-defined salt. Using a &#39;salt&#39; would then hash key_parameter+salt into binary_56_byte_hashed_key+hash_derived_IV, which shields the IV from someone who doesn&#39;t know the key. If they tried to bit-flip the salt, the generated encryption key and IV would be completely different, and the message would decrypt to garbage. Another way would be to include 8 garbage bytes preceding the actual message. The garbage bytes would be thrown away and only bytes 9+ of the decoded message are used.<br/>
</p><p>Note: If using v7.52-7.55, beware of non-literal key parameter silently chopped to 56 bytes. The following examples always produce identical output in those versions each time the command is repeated, demonstrating silent ignore of key beyond byte 56.
</p>
<pre><span class="code_line">CBC hashed-key with salt:</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">//echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$version" title="$version - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$version</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>testtest,mcs,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>a,55<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a><span class="mirc_bracket">(</span>192,255<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> ,saltsalt<span class="mirc_bracket">)</span></span>
<span class="code_line">CBC literal key with IV:</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">//echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$version" title="$version - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$version</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>testtest,mcirl,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>a,55<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a><span class="mirc_bracket">(</span>192,255<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> , <span class="mirc_bracket">(</span>8<span class="mirc_bracket">)</span>bytes<span class="mirc_bracket">)</span></span>
<span class="code_line">ECB literal key:</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">//echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$version" title="$version - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$version</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>testtest,me,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>a,55<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a><span class="mirc_bracket">(</span>192,255<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> <span class="mirc_bracket">)</span></span>
<span class="code_line">CBC hashed-key with IV:</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">//echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$version" title="$version - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$version</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>testtest,mcir,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>a,55<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a><span class="mirc_bracket">(</span>192,255<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> , <span class="mirc_bracket">(</span>8<span class="mirc_bracket">)</span>bytes<span class="mirc_bracket">)</span></span></pre>
<p>Note: &#39;mc&#39; or &#39;mcr&#39; or &#39;mcrl&#39; switch combos also silently ignored the 57th-and-later bytes in those versions, as demonstrated by being able to decode those messages without the full key:
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> -s <span class="mirc_variable">%msg</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>testtest,mc,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>a,56<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> key<span class="mirc_bracket">)</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$version" title="$version - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$version</span></a> : <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%msg</span>,mc,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>a,56<span class="mirc_bracket">)</span> <span class="mirc_bracket">)</span></span></pre>
<p>Security flaws remaining with v7.56:
</p>
<pre><span class="code_line">1. Allows encrypting where the key parameter is <a href="http://en.wikichip.org/wiki/mirc/identifiers/$null" title="$null - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$null</span></a>:</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">//echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>message,mc,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$null" title="$null - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$null</span></a><span class="mirc_bracket">)</span></span>
<span class="code_line">Your script must check to verify that <span class="mirc_variable">%key</span> is not null, or possibly halt the script such as with <a href="http://en.wikichip.org/wiki/mirc/identifiers/$$+" title="$$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$$+</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%key<span class="mirc_bracket">)</span>.</span></span>
<span class="code_line">2. Silently ignores invalid salt and IV parameters longer than 8, producing identical outputs, such as when using <a href="http://en.wikichip.org/wiki/mirc/identifiers/$ctime" title="$ctime - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$ctime</span></a> as the IV during a 100-seconds interval:</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/timer" title="/timer - mIRC Command" style="text-decoration: none"><span class="mirc_command">/timer</span></a> 110 1 echo -sg <a href="http://en.wikichip.org/wiki/mirc/identifiers/$ctime" title="$ctime - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$ctime</span></a> : <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>message,mcs,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$null" title="$null - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$null</span></a>,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$ctime" title="$ctime - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$ctime</span></a><span class="mirc_bracket">)</span></span>
<span class="code_line"><span class="mirc_bracket">(</span>Only difference between &#39;i&#39; and &#39;ir&#39; is that &#39;ir&#39; stuffs the IV parm into the header as if it&#39;s random. The extra 16 byte header lengthens the encrypted string. Your script must verify that <a href="http://en.wikichip.org/wiki/mirc/identifiers/$len" title="$len - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$len</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%saltparameter<span class="mirc_bracket">)</span></span> is not greater than 8.</span>
<span class="code_line">3. Padding is broken because <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a> does not let you recover the original message by specifying the 1 of 4 types of padding to remove. Also, other than scripting to check the length a decrypted &amp;binvar, <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a> does not warn you that the message did not contain valid padding, and even then it does not warn you if the wrong kind of padding was matched. For every message encoded using &#39;z&#39; padding that&#39;s not a multiple of 8 bytes and which ends with a codepoint that&#39;s a multiple of 64 greater than 64 ends with the byte value 128: <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a> makes a false match with &#39;n&#39; padding, causing the final byte of the last character&#39;s encoding to be stripped, resulting in the final character of the text being displayed incorrectly. Your script should encode use the &#39;n&#39; switch or using none of the n|p|z switches. By not warning whether the padding was wrong/missing, this makes it hard to detect whether the string has been maliciously truncated intransit.</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/bset" title="/bset - mIRC Command" style="text-decoration: none"><span class="mirc_command">//bset</span></a> -t &amp;v 8 0 | <span class="mirc_control">while</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;v,0<span class="mirc_bracket">)</span> == 8<span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span><a href="http://en.wikichip.org/wiki/mirc/commands/bset" title="/bset - mIRC Command" style="text-decoration: none"><span class="mirc_command"> bset</span></a> -tc &amp;v 1 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$str" title="$str - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$str</span></a><span class="mirc_bracket">(</span>.,<a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a><span class="mirc_bracket">(</span>1,7<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$calc" title="$calc - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$calc</span></a><span class="mirc_bracket">(</span>64*<a href="http://en.wikichip.org/wiki/mirc/identifiers/$rand" title="$rand - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$rand</span></a><span class="mirc_bracket">(</span>3,1023<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> <span class="mirc_bracket">}</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a original: = <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;v,1-<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;v,1-<span class="mirc_bracket">)</span>.text |<a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command"> noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>&amp;v,bmcz,key<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span>&amp;v,bmcz,key<span class="mirc_bracket">)</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> 4 -a decrypted = <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;v,1-<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bvar" title="$bvar - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bvar</span></a><span class="mirc_bracket">(</span>&amp;v,1-<span class="mirc_bracket">)</span>.text</span></pre>
<ul><li> NOTE: Your key should be long enough to make it difficult for someone to brute-force guess it. You can&#39;t count on the guesser using a mIRC script which contains overhead which slows down the guessing. Beginning v7.56, you can use a longer key parameter up to 612 bytes, and 7.72 increases to 2148 bytes, and that string will be hashed to generate the key, instead of the hashing looking at only the 1st 56 bytes of the key parameter. When using &#39;r&#39; without &#39;l&#39;, the key parameter is hashed in a way which does not generate more than 2^128 possible keys. The hash is derived using the $md5 function, so $encode(string,mcir,%key,iv) generates identical encryption passwords from all %key which have matching MD5 hash.</li></ul>
<p>When using a salted key (&#39;c&#39; without &#39;r&#39; or &#39;i&#39; switches) the hash method has some 448-bit keys which can never be generated from every salt string, but all possible long key parameter strings against a fixed salt can generate well over 2^400 different encryption keys.<br/>
</p><p>While the encryption does not include authentication, that issue can be largely mitigated. Authentication would involve a lengthening of the ciphertext which can make it less likely that the encoded encrypted string can fit within the limited length of an IRC message. However, when using a salt, both the per-message key and per-message IV are a hash result that&#39;s shielded from trivial tampering. To defend against the ciphertext being chopped short, if the ciphertext is in a &amp;binvar, you can determine the decrypted padded-message-length inside the ciphertext based on the length of the mime string, so if the decoded string length indicates that no padding was removed, that indicates that the ciphertext was not created by $encode. There is still a small chance that padding can be removed from a truncated message without containing spurious characters, but you can also do something like ending your plaintext always with a string that you never put into the message, like XYZ, and then can check that your decrypted message ends with your magic label.
</p>
<h2><span class="mw-headline" id="Compatibility">Compatibility</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit&amp;section=6" title="Edit section: Compatibility">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Added: mIRC v5.8<br/>
Added on: 05 Sep 2000<br/>
<small>
<b>Note:</b> Unless otherwise stated, this was the date of original functionality.<br/>
Further enhancements may have been made in later versions.
</small>
</p>
<h2><span class="mw-headline" id="See_Also">See Also</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/identifiers/$encode&amp;action=edit&amp;section=7" title="Edit section: See Also">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a href="/wiki/mirc/identifiers/$decode" title="mirc/identifiers/$decode">$decode</a></li>
<li> <a href="/wiki/mirc/identifiers/$rand" title="mirc/identifiers/$rand">$rand</a></li>
<li> <a href="/wiki/mirc/identifiers/$rands" title="mirc/identifiers/$rands">$rands</a></li></ul>

<!-- Saved in parser cache with key wikichip:pcache:idhash:1269-0!*!0!!en!*!* and timestamp 20240530070131 and revision id 101568
 -->
</div><div class="visualClear"></div><div class="printfooter">Retrieved from &#34;<a dir="ltr" href="https://en.wikichip.org/w/index.php?title=mirc/identifiers/$encode&amp;oldid=101568">https://en.wikichip.org/w/index.php?title=mirc/identifiers/$encode&amp;oldid=101568</a>&#34;</div><div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>				</div>
				
</div> <!-- mw-body-content END -->
</div> <!-- mw-body-content enclosure END -->
</div> <!-- wikichip-body-container END -->
<!-- wikichip-bottom START -->
<div id="wikichip-bottom">
    <!-- wikichip-footer-cont START -->
    <div id="wikichip-footer-cont">
    <!-- wikichip-afooter START -->
        <div id="wikichip-afooter">
                    	
			<!-- Ezoic - wikichip/global/footer - bottom_of_page -->
			<div id="ezoic-pub-ad-placeholder-127">
                	        <script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                	        <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1951113009523412" data-ad-slot="3591436790" data-ad-format="auto"></ins>
                	        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
			</div>
			<!-- End Ezoic - wikichip/global/footer - bottom_of_page -->

			                            </div>
    <!-- wikichip-afooter END -->
    <!-- wikichip-footer START -->
        <div id="wikichip-footer">

                                <div id="footer-last-mod">
                         This page was last modified on 16 April 2023, at 04:32.                        </div>
                                <div id="footer-places"><ul>
                        <li><a href="/wiki/WikiChip:Privacy_policy" title="WikiChip:Privacy policy">Privacy policy</a></li><li><a href="/wiki/WikiChip:About" title="WikiChip:About">About WikiChip</a></li><li><a href="/wiki/WikiChip:General_disclaimer" title="WikiChip:General disclaimer">Disclaimers</a></li>                        </ul></div>
                        
        </div>
    <!-- wikichip-footer END -->
    </div>
    <!-- wikichip-footer-cont END -->
</div>
<!-- wikichip-bottom START -->
 
    
    
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.smw.tooltips","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.headertabs","ext.headertabs.large","skins.WikiChip2.js"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":651});});</script></div>
<!-- A:IL01 START -->
<script type="text/javascript"> var infolinks_pid = 3234819; var infolinks_wsid = 0;</script>
<script type="text/javascript" src="//resources.infolinks.com/js/infolinks%5Fmain.js"></script>
<!-- A:IL01 END -->




<script>__ez.queue.addFile('/tardisrocinante/vitals.js', '/tardisrocinante/vitals.js?gcb=3&cb=4', false, ['/parsonsmaize/mulvane.js'], true, false, true, false);</script>
<script>var _audins_dom="wikichip_org",_audins_did=86609;__ez.queue.addDelayFunc("audins.js","__ez.script.add", "//go.ezodn.com/detroitchicago/audins.js?cb=3");</script><noscript><div style="display:none;"><img src="//pixel.quantserve.com/pixel/p-31iz6hfFutd16.gif?labels=Domain.wikichip_org,DomainId.86609" border="0" height="1" width="1" alt="Quantcast"/></div></noscript>
<script>__ez.queue.addFile('/beardeddragon/drake.js', '/beardeddragon/drake.js?gcb=3&cb=8', false, [], true, false, true, false);</script>
<script type="text/javascript" style='display:none;'>var __ez_dims = (function() {
		var setCookie = function( name, content, expiry ) {
			return document.cookie = name+'='+content+((expiry)?';expires='+(new Date(Math.floor(new Date().getTime()+expiry*1000)).toUTCString()):'')+';path=/';
		};
		var ffid = 1;
		var oh = window.screen.height;
		var ow = window.screen.width;
		var h = ffid === 1 ? oh : (oh > ow) ? oh : ow;
		var w = ffid === 1 ? ow : (oh > ow) ? ow : oh;
		var uh = window.innerHeight || document.documentElement.clientHeight || document.getElementsByTagName('body')[0].clientHeight;
		var uw = window.innerWidth || document.documentElement.clientWidth || document.getElementsByTagName('body')[0].clientWidth;
	
		var setAllCookies = function() {
			setCookie('ezds', encodeURIComponent('ffid='+ffid+',w='+w+',h='+h), (31536e3*7));
			setCookie('ezohw', encodeURIComponent('w='+uw+',h='+uh), (31536e3*7));    
		};
	
		if (window.ezTcfConsent && window.ezTcfConsent.loaded) {
			if (window.ezTcfConsent.understand_audiences) { 
				setAllCookies();
			}
		} else if (typeof getEzConsentData === "function") {
			getEzConsentData().then(function (ezTcfConsent) {
				if (ezTcfConsent && ezTcfConsent.loaded) {
					if (ezTcfConsent.understand_audiences) { 
						setAllCookies();
					}
				} else {
					console.error("cannot get ez consent data");
					setAllCookies();
				}
			});
		} else {
			console.error("getEzConsentData is not a function");
			setAllCookies();
		}
	
	})();</script>
<script type='text/javascript' style='display:none;' async>__ez.queue.addFile('/parsonsmaize/chanute.js', '/parsonsmaize/chanute.js?a=a&cb=9&dcb=195-3&shcb=34', true, ['/parsonsmaize/mulvane.js'], true, false, false, false);</script>
<script type='text/javascript' style='display:none;' async>__ez.queue.addFile('/porpoiseant/jellyfish.js', '/porpoiseant/jellyfish.js?a=a&cb=16&dcb=195-3&shcb=34', false, [], true, false, false, false);</script>
<script>if(typeof _ezaq!=="undefined"&&typeof __ez=="object"&&typeof __ez.bit=="object"&&typeof __ezDotData=="function"){if("cookieDeprecationLabel"in navigator){navigator.cookieDeprecationLabel.getValue().then((label)=>{__ez.bit.AddAndFire(_ezaq["page_view_id"],[new __ezDotData("chrome_cookie_deprecation_label",label),]);});}}</script><script data-cfasync="false">function _emitEzConsentEvent(){var customEvent=new CustomEvent("ezConsentEvent",{detail:{ezTcfConsent:window.ezTcfConsent},bubbles:true,cancelable:true,});document.dispatchEvent(customEvent);}
(function(window,document){function _setAllEzConsentTrue(){window.ezTcfConsent.loaded=true;window.ezTcfConsent.store_info=true;window.ezTcfConsent.develop_and_improve_services=true;window.ezTcfConsent.measure_ad_performance=true;window.ezTcfConsent.measure_content_performance=true;window.ezTcfConsent.select_basic_ads=true;window.ezTcfConsent.create_ad_profile=true;window.ezTcfConsent.select_personalized_ads=true;window.ezTcfConsent.create_content_profile=true;window.ezTcfConsent.select_personalized_content=true;window.ezTcfConsent.understand_audiences=true;window.ezTcfConsent.use_limited_data_to_select_content=true;window.ezTcfConsent.select_personalized_content=true;}
function _clearEzConsentCookie(){document.cookie="ezCMPCookieConsent=tcf2;Domain=.wikichip.org;Path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT";}
_clearEzConsentCookie();if(typeof window.__tcfapi!=="undefined"){window.ezgconsent=false;var amazonHasRun=false;function _ezAllowed(tcdata,purpose){return(tcdata.purpose.consents[purpose]||tcdata.purpose.legitimateInterests[purpose]);}
function _reloadAds(){if(typeof window.ezorefgsl==="function"&&typeof window.ezslots==="object"){if(typeof __ezapsFetchBids=="function"&&amazonHasRun===false){ezapsFetchBids(__ezaps);if(typeof __ezapsVideo!="undefined"){ezapsFetchBids(__ezapsVideo,"video");}
amazonHasRun=true;}
var slots=[];for(var i=0;i<window.ezslots.length;i++){if(window[window.ezslots[i]]&&typeof window[window.ezslots[i]]==="object"){slots.push(window[window.ezslots[i]]);}else{setTimeout(_reloadAds,100);return false;}}
for(var i=0;i<slots.length;i++){window.ezorefgsl(slots[i]);}}else if(!window.ezadtimeoutset){window.ezadtimeoutset=true;setTimeout(_reloadAds,100);}}
function _handleConsentDecision(tcdata){window.ezTcfConsent.loaded=true;if(!tcdata.vendor.consents["347"]&&!tcdata.vendor.legitimateInterests["347"]){window._emitEzConsentEvent();return;}
window.ezTcfConsent.store_info=_ezAllowed(tcdata,"1");window.ezTcfConsent.develop_and_improve_services=_ezAllowed(tcdata,"10");window.ezTcfConsent.measure_content_performance=_ezAllowed(tcdata,"8");window.ezTcfConsent.select_basic_ads=_ezAllowed(tcdata,"2");window.ezTcfConsent.create_ad_profile=_ezAllowed(tcdata,"3");window.ezTcfConsent.select_personalized_ads=_ezAllowed(tcdata,"4");window.ezTcfConsent.create_content_profile=_ezAllowed(tcdata,"5");window.ezTcfConsent.measure_ad_performance=_ezAllowed(tcdata,"7");window.ezTcfConsent.use_limited_data_to_select_content=_ezAllowed(tcdata,"11");window.ezTcfConsent.select_personalized_content=_ezAllowed(tcdata,"6");window.ezTcfConsent.understand_audiences=_ezAllowed(tcdata,"9");window._emitEzConsentEvent();}
function _handleGoogleConsentV2(tcdata){if(!tcdata||!tcdata.purpose||!tcdata.purpose.consents){return;}
var googConsentV2={};if(tcdata.purpose.consents[1]){googConsentV2.ad_storage='granted';googConsentV2.analytics_storage='granted';}
if(tcdata.purpose.consents[3]&&tcdata.purpose.consents[4]){googConsentV2.ad_personalization='granted';}
if(tcdata.purpose.consents[1]&&tcdata.purpose.consents[7]){googConsentV2.ad_user_data='granted';}
if(googConsentV2.analytics_storage=='denied'){gtag('set','url_passthrough',true);}
gtag('consent','update',googConsentV2);}
__tcfapi("addEventListener",2,function(tcdata,success){if(!success||!tcdata){window._emitEzConsentEvent();return;}
if(!tcdata.gdprApplies){_setAllEzConsentTrue();window._emitEzConsentEvent();return;}
if(tcdata.eventStatus==="useractioncomplete"||tcdata.eventStatus==="tcloaded"){if(typeof gtag!='undefined'){_handleGoogleConsentV2(tcdata);}
_handleConsentDecision(tcdata);if(tcdata.purpose.consents["1"]===true&&tcdata.vendor.consents["755"]!==false){window.ezgconsent=true;(adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0;_reloadAds();}else{_reloadAds();}
if(window.__ezconsent){__ezconsent.setEzoicConsentSettings(ezConsentCategories);}
__tcfapi("removeEventListener",2,function(success){return null;},tcdata.listenerId);if(!(tcdata.purpose.consents["1"]===true&&_ezAllowed(tcdata,"2")&&_ezAllowed(tcdata,"3")&&_ezAllowed(tcdata,"4"))){if(typeof __ez=="object"&&typeof __ez.bit=="object"&&typeof window["_ezaq"]=="object"&&typeof window["_ezaq"]["page_view_id"]=="string"){__ez.bit.AddAndFire(window["_ezaq"]["page_view_id"],[new __ezDotData("non_personalized_ads",true),]);}}}});}else{_setAllEzConsentTrue();window._emitEzConsentEvent();}})(window,document);</script></body></html>