<!DOCTYPE html><html class="client-nojs" lang="en" dir="ltr"><head><meta charset="UTF-8"/>
<script>var _ez_ab_test = 'mod45-c'</script>
<script>var __ezHttpConsent={setByCat:function(src,tagType,attributes,category,force){var setScript=function(){if(force||window.ezTcfConsent[category]){var scriptElement=document.createElement(tagType);scriptElement.src=src;attributes.forEach(function(attr){for(var key in attr){if(attr.hasOwnProperty(key)){scriptElement.setAttribute(key,attr[key]);}}});var firstScript=document.getElementsByTagName(tagType)[0];firstScript.parentNode.insertBefore(scriptElement,firstScript);}};if(force||(window.ezTcfConsent&&window.ezTcfConsent.loaded)){setScript();}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){setScript();}else{console.error("cannot get ez consent data");force=true;setScript();}});}else{force=true;setScript();console.error("getEzConsentData is not a function");}},};</script>
<script>var ezTcfConsent=window.ezTcfConsent?window.ezTcfConsent:{loaded:false,store_info:false,develop_and_improve_services:false,measure_ad_performance:false,measure_content_performance:false,select_basic_ads:false,create_ad_profile:false,select_personalized_ads:false,create_content_profile:false,select_personalized_content:false,understand_audiences:false,use_limited_data_to_select_content:false,};function getEzConsentData(){return new Promise(function(resolve){document.addEventListener("ezConsentEvent",function(event){var ezTcfConsent=event.detail.ezTcfConsent;resolve(ezTcfConsent);});});}</script>
<script>function _setEzCookies(ezConsentData){var cookies=[{name:"ezoadgid_86609",value:"-1; Path=/; Domain=wikichip.org; Expires=Sun, 25 Feb 2024 02:47:29 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezoref_86609",value:"; Path=/; Domain=wikichip.org; Expires=Sun, 25 Feb 2024 04:17:29 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezosuibasgeneris-1",value:"698c234a-249a-496d-5ea4-a519521ee81c; Path=/; Domain=wikichip.org; Expires=Mon, 24 Feb 2025 02:17:29 UTC; Secure; SameSite=None",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezoab_86609",value:"mod45-c; Path=/; Domain=wikichip.org; Expires=Sun, 25 Feb 2024 04:17:29 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"active_template::86609",value:"pub_site.1708827449; Path=/; Domain=wikichip.org; Expires=Tue, 27 Feb 2024 02:17:29 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"ezopvc_86609",value:"1; Path=/; Domain=wikichip.org; Expires=Sun, 25 Feb 2024 02:47:30 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"lp_86609",value:"/wiki/MSL_Injection_-_mIRC; Path=/; Domain=wikichip.org; Expires=Sun, 25 Feb 2024 02:47:30 UTC",tcfCategory:"store_info",isEzoic:"true",},{name:"ezovuuidtime_86609",value:"1708827450; Path=/; Domain=wikichip.org; Expires=Tue, 27 Feb 2024 02:17:30 UTC",tcfCategory:"understand_audiences",isEzoic:"true",},{name:"ezovuuid_86609",value:"8c595e88-4764-4f6a-5a2d-8eef331b4c13; Path=/; Domain=wikichip.org; Expires=Sun, 25 Feb 2024 02:47:30 UTC",tcfCategory:"understand_audiences",isEzoic:"true",}];for(var i=0;i<cookies.length;i++){var cookie=cookies[i];if(ezConsentData&&ezConsentData.loaded&&ezConsentData[cookie.tcfCategory]){document.cookie=cookie.name+"="+cookie.value;}}}
if(window.ezTcfConsent&&window.ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else if(typeof getEzConsentData==="function"){getEzConsentData().then(function(ezTcfConsent){if(ezTcfConsent&&ezTcfConsent.loaded){_setEzCookies(window.ezTcfConsent);}else{console.error("cannot get ez consent data");_setEzCookies(window.ezTcfConsent);}});}else{console.error("getEzConsentData is not a function");_setEzCookies(window.ezTcfConsent);}</script>
<script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>var __ez=__ez||{};__ez.stms=Date.now();__ez.evt={};__ez.script={};__ez.ck=__ez.ck||{};__ez.template={};__ez.template.isOrig=true;window.__ezScriptHost="//www.ezojs.com";__ez.queue=function(){var e=0,i=0,t=[],n=!1,o=[],r=[],s=!0,a=function(e,i,n,o,r,s,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,d=this;this.name=e,this.funcName=i,this.parameters=null===n?null:p(n)?n:[n],this.isBlock=o,this.blockedBy=r,this.deleteWhenComplete=s,this.isError=!1,this.isComplete=!1,this.isInitialized=!1,this.proceedIfError=a,this.fWindow=l,this.isTimeDelay=!1,this.process=function(){f("... func = "+e),d.isInitialized=!0,d.isComplete=!0,f("... func.apply: "+e);var i=d.funcName.split("."),n=null,o=this.fWindow||window;i.length>3||(n=3===i.length?o[i[0]][i[1]][i[2]]:2===i.length?o[i[0]][i[1]]:o[d.funcName]),null!=n&&n.apply(null,this.parameters),!0===d.deleteWhenComplete&&delete t[e],!0===d.isBlock&&(f("----- F'D: "+d.name),u())}},l=function(e,i,t,n,o,r,s){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:window,l=this;this.name=e,this.path=i,this.async=o,this.defer=r,this.isBlock=t,this.blockedBy=n,this.isInitialized=!1,this.isError=!1,this.isComplete=!1,this.proceedIfError=s,this.fWindow=a,this.isTimeDelay=!1,this.isPath=function(e){return"/"===e[0]&&"/"!==e[1]},this.getSrc=function(e){return void 0!==window.__ezScriptHost&&this.isPath(e)&&"banger.js"!==this.name?window.__ezScriptHost+e:e},this.process=function(){l.isInitialized=!0,f("... file = "+e);var i=this.fWindow?this.fWindow.document:document,t=i.createElement("script");t.src=this.getSrc(this.path),!0===o?t.async=!0:!0===r&&(t.defer=!0),t.onerror=function(){var e={url:window.location.href,name:l.name,path:l.path,user_agent:window.navigator.userAgent};"undefined"!=typeof _ezaq&&(e.pageview_id=_ezaq.page_view_id);var i=encodeURIComponent(JSON.stringify(e)),t=new XMLHttpRequest;t.open("GET","//g.ezoic.net/ezqlog?d="+i,!0),t.send(),f("----- ERR'D: "+l.name),l.isError=!0,!0===l.isBlock&&u()},t.onreadystatechange=t.onload=function(){var e=t.readyState;f("----- F'D: "+l.name),e&&!/loaded|complete/.test(e)||(l.isComplete=!0,!0===l.isBlock&&u())},i.getElementsByTagName("head")[0].appendChild(t)}},d=function(e,i){this.name=e,this.path="",this.async=!1,this.defer=!1,this.isBlock=!1,this.blockedBy=[],this.isInitialized=!0,this.isError=!1,this.isComplete=i,this.proceedIfError=!1,this.isTimeDelay=!1,this.process=function(){}};function c(e){!0!==h(e)&&0!=s&&e.process()}function h(e){if(!0===e.isTimeDelay&&!1===n)return f(e.name+" blocked = TIME DELAY!"),!0;if(p(e.blockedBy))for(var i=0;i<e.blockedBy.length;i++){var o=e.blockedBy[i];if(!1===t.hasOwnProperty(o))return f(e.name+" blocked = "+o),!0;if(!0===e.proceedIfError&&!0===t[o].isError)return!1;if(!1===t[o].isComplete)return f(e.name+" blocked = "+o),!0}return!1}function f(e){var i=window.location.href,t=new RegExp("[?&]ezq=([^&#]*)","i").exec(i);"1"===(t?t[1]:null)&&console.debug(e)}function u(){++e>200||(f("let's go"),m(o),m(r))}function m(e){for(var i in e)if(!1!==e.hasOwnProperty(i)){var t=e[i];!0===t.isComplete||h(t)||!0===t.isInitialized||!0===t.isError?!0===t.isError?f(t.name+": error"):!0===t.isComplete?f(t.name+": complete already"):!0===t.isInitialized&&f(t.name+": initialized already"):t.process()}}function p(e){return"[object Array]"==Object.prototype.toString.call(e)}return window.addEventListener("load",(function(){setTimeout((function(){n=!0,f("TDELAY -----"),u()}),5e3)}),!1),{addFile:function(e,i,n,s,a,d,h,f,u){var m=new l(e,i,n,s,a,d,h,u);!0===f?o[e]=m:r[e]=m,t[e]=m,c(m)},addDelayFile:function(e,i){var n=new l(e,i,!1,[],!1,!1,!0);n.isTimeDelay=!0,f(e+" ...  FILE! TDELAY"),r[e]=n,t[e]=n,c(n)},addFunc:function(e,n,s,l,d,h,f,u,m,p){!0===h&&(e=e+"_"+i++);var w=new a(e,n,s,l,d,f,u,p);!0===m?o[e]=w:r[e]=w,t[e]=w,c(w)},addDelayFunc:function(e,i,n){var o=new a(e,i,n,!1,[],!0,!0);o.isTimeDelay=!0,f(e+" ...  FUNCTION! TDELAY"),r[e]=o,t[e]=o,c(o)},items:t,processAll:u,setallowLoad:function(e){s=e},markLoaded:function(e){if(e&&0!==e.length){if(e in t){var i=t[e];!0===i.isComplete?f(i.name+" "+e+": error loaded duplicate"):(i.isComplete=!0,i.isInitialized=!0)}else t[e]=new d(e,!0);f("markLoaded dummyfile: "+t[e].name)}},logWhatsBlocked:function(){for(var e in t)!1!==t.hasOwnProperty(e)&&h(t[e])}}}();__ez.evt.add=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n()},__ez.evt.remove=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):delete e["on"+t]};__ez.script.add=function(e){var t=document.createElement("script");t.src=e,t.async=!0,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)};__ez.dot={};__ez.queue.addFile('/detroitchicago/boise.js', '/detroitchicago/boise.js?gcb=195-3&cb=5', true, [], true, false, true, false);__ez.queue.addFile('/parsonsmaize/abilene.js', '/parsonsmaize/abilene.js?gcb=195-3&cb=33', true, [], true, false, true, false);</script>
<script data-ezscrex="false" type="text/javascript" data-cfasync="false">window._ezaq = Object.assign({}, typeof window._ezaq !== "undefined" ? window._ezaq : {}, {"ad_cache_level":1,"domain_id":86609,"ezcache_level":0,"ezcache_skip_code":0,"has_bad_image":0,"has_bad_words":0,"is_sitespeed":0,"lt_cache_level":0,"page_view_id":"1fafa646-efd6-4062-7e08-61dc59a3b1a5","response_size_orig":113891,"response_time_orig":160,"template_id":5,"url":"/wiki/MSL_Injection_-_mIRC","visit_uuid":"8c595e88-4764-4f6a-5a2d-8eef331b4c13","word_count":0,"worst_bad_word_level":0});__ez.queue.markLoaded('ezaqBaseReady');</script>
<script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>__ez.queue.addFile('/parsonsmaize/mulvane.js', '/parsonsmaize/mulvane.js?gcb=195-3&cb=6', true, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('/parsonsmaize/olathe.js', '/parsonsmaize/olathe.js?gcb=195-3&cb=24', false, ['/parsonsmaize/abilene.js','/parsonsmaize/mulvane.js'], true, false, true, false);__ez.queue.addFile('/porpoiseant/et.js', '/porpoiseant/et.js?gcb=195-3&cb=2', false, [], true, false, true, false);!function(){var e=function(e,i,t){var o=[],n=null;return{Add:function(t,d){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(__ez.dot.isDefined(t)&&__ez.dot.isValid(d))if(n==t&&o.length>0&&o[o.length-1].data.length+d.length<=5)o[o.length-1].data=o[o.length-1].data.concat(__ez.dot.dataToStr(d));else{var _={type:e,domain_id:__ez.dot.getDID(),t_epoch:__ez.dot.getEpoch(0),data:__ez.dot.dataToStr(d)};_[i]=t,a&&a.hasOwnProperty("impression_id")&&a.hasOwnProperty("ad_unit")&&(_.impression_id=a.impression_id.toString(),_.unit=a.ad_unit),o.push(_),n=t}},Fire:function(){if(void 0===document.visibilityState||"prerender"!==document.visibilityState){if(__ez.dot.isDefined(o)&&o.length>0)for(;o.length>0;){var e=5;e>o.length&&(e=o.length);var i=o.splice(0,e),n=__ez.dot.getURL(t)+"?orig="+(!0===__ez.template.isOrig?1:0)+"&v="+btoa(JSON.stringify(i));__ez.dot.Fire(n)}o=[]}}}};__ez.vep=e("video","video_impression_id","/detroitchicago/grapefruit.gif"),__ez.vaep=e("video-ad","video_ad_impression_id","/porpoiseant/lemon.gif"),__ez.osvaep=e("outstream-video-ad","video_ad_impression_id","/porpoiseant/tangerine.gif")}();</script><script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>__ez.queue.addFile('/detroitchicago/wichita.js', '/detroitchicago/wichita.js?gcb=195-3&cb=12', false, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('/detroitchicago/raleigh.js', '/detroitchicago/raleigh.js?gcb=195-3&cb=7', false, ['/parsonsmaize/abilene.js'], true, false, true, false);__ez.queue.addFile('/detroitchicago/vista.js', '/detroitchicago/vista.js?gcb=195-3&cb=6', false, ['/parsonsmaize/abilene.js'], true, false, true, false);</script><base href="/wiki/MSL_Injection_-_mIRC"/>

<title>mSL Injection - mIRC - WikiChip</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"mirc/msl_injection","wgTitle":"mirc/msl injection","wgCurRevisionId":101076,"wgRevisionId":101076,"wgArticleId":38,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"mirc/msl_injection","wgRelevantArticleId":38,"wgRequestId":"5d349d9cb26116b2bb11906d","wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"MSL_Injection_-_mIRC","wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"preview":true,"publish":true},"wgPageFormsAutocompleteValues":[],"wgPageFormsAutocompleteOnAllChars":false,"wgPageFormsFieldProperties":[],"wgPageFormsCargoFields":[],"wgPageFormsDependentFields":[],"wgPageFormsGridValues":[],"wgPageFormsGridParams":[],"wgPageFormsShowOnSelect":[],"wgPageFormsScriptPath":"/w/extensions/PageForms","edgValues":null,"wgPageFormsEDSettings":null,"wgHeaderTabsTabIndexes":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}","wgInternalRedirectTargetUrl":"/wiki/mirc/msl_injection"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","ext.mirc":"ready","ext.smw.style":"ready","ext.smw.tooltip.styles":"ready","mediawiki.skinning.interface":"ready","mediawiki.skinning.content.externallinks":"ready","skins.WikiChip2":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1glvl31",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.action.view.redirect","ext.smw.style","mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=ext.mirc%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.WikiChip2&amp;only=styles&amp;skin=WikiChip2"/>
<link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=ext.smw.style%7Cext.smw.tooltip.styles&amp;only=styles&amp;skin=WikiChip2"/>
<script async="" src="/w/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=WikiChip2"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=WikiChip2"/>
<meta name="generator" content="MediaWiki 1.28.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="ExportRDF" type="application/rdf+xml" title="mirc/msl injection" href="/w/index.php?title=Special:ExportRDF/mirc/msl_injection&amp;xmlmime=rdf"/>
<link rel="alternate" type="application/x-wiki" title="Edit" href="/w/index.php?title=mirc/msl_injection&amp;action=edit"/>
<link rel="edit" title="Edit" href="/w/index.php?title=mirc/msl_injection&amp;action=edit"/>
<link rel="shortcut icon" href="/w/resources/assets/wikichip.png"/>
<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="WikiChip (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="/w/api.php?action=rsd"/>
<link rel="canonical" href="/wiki/mirc/msl_injection"/>
<meta name="twitter:site" content="@WikiChip"/>
<meta name="twitter:image" content="/w/resources/assets/og_wikichip_logo.png"/>
<meta property="og:image" content="/w/resources/assets/og_wikichip_logo.png"/>
<meta property="og:title" content="mSL Injection - mIRC - WikiChip"/>
<meta name="twitter:card" content="summary"/>
<meta property="og:type" content="article"/>
<meta property="twitter:description" content="mSL injection (mIRC Scripting Language injection) is a code injection technique that exploits mIRC&#39;s ability to dynamically evaluate code on the run. With mSLs powerful commands and identifiers, the result of a code injection attack can be disastrous. It is important that you understand what to look for when working with vulnerable commands."/>
<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css?family=Josefin+Sans:400,700&amp;display=swap" rel="stylesheet"/>
<script type='text/javascript'>
var ezoTemplate = 'orig_site';
var ezouid = '1';
var ezoFormfactor = '1';
</script><script data-ezscrex="false" type='text/javascript'>
var soc_app_id = '0';
var did = 86609;
var ezdomain = 'wikichip.org';
var ezoicSearchable = 1;
</script>
<script data-ezscrex="false" type="text/javascript" data-cfasync="false">var _ezaq = window._ezaq = Object.assign({}, typeof window._ezaq !== "undefined" ? window._ezaq : {}, {"ab_test_id":"mod45-c","ad_cache_level":1,"ad_lazyload_version":0,"ad_load_version":0,"city":"Ashburn","country":"US","days_since_last_visit":-1,"domain_id":86609,"domain_test_group":20230808,"engaged_time_visit":0,"ezcache_level":0,"ezcache_skip_code":0,"form_factor_id":1,"framework_id":1,"has_bad_image":0,"has_bad_words":0,"is_embed":false,"is_return_visitor":false,"is_sitespeed":0,"last_page_load":"","last_pageview_id":"","lt_cache_level":0,"metro_code":511,"page_ad_positions":"","page_view_count":0,"page_view_id":"1fafa646-efd6-4062-7e08-61dc59a3b1a5","position_selection_id":0,"postal_code":"20149","pv_event_count":0,"response_size_orig":113891,"response_time_orig":160,"serverid":"i-0e8a2dc30a0549ab9","state":"VA","t_epoch":1708827449,"template_id":5,"time_on_site_visit":0,"url":"/wiki/MSL_Injection_-_mIRC","visit_uuid":"8c595e88-4764-4f6a-5a2d-8eef331b4c13","word_count":4814,"worst_bad_word_level":0});__ez.queue.markLoaded('ezaqReady');var _ezExtraQueries = "&ez_orig=1";</script>
<script src="/detroitchicago/ezd.js?gcb=195-3&cb=4" defer async></script>
<script data-ezscrex='false' data-pagespeed-no-defer data-cfasync='false'>function create_ezolpl() {
	var d = new Date();
	d.setTime(d.getTime() + 365 * 24 * 60 * 60 * 1000);
	var expires = "expires=" + d.toUTCString();
	__ez.ck.setByCat(
	  "ezux_lpl_86609",
	  new Date().getTime() +
		"|" +
		_ezaq.page_view_id +
		"|" +
		_ezaq.is_return_visitor +
		"; " +
		expires,
	  "understand_audiences",
	  false
	);
  }
  function attach_ezolpl() {
	if (document.readyState === "complete") {
	  create_ezolpl();
	  return;
	}
	window.addEventListener("load", create_ezolpl);
  }  

__ez.queue.addFunc("attach_ezolpl", "attach_ezolpl", null, false, ['/detroitchicago/boise.js'], true, false, false, false);
</script></head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-mirc_msl_injection rootpage-mirc skin-WikiChip2 action-view">
<div id="mw-wrapper">
<div class="mw-body" role="main">
<!-- wikichip-header START -->
<div id="wikichip-header">
            <div id="wikichip-header-logo">
                <a href="/wiki/WikiChip"><img src="//en.wikichip.org/w/resources/assets/wikichip_logo4.svg" width="200px"/></a><br/>
                <span id="tagline">Semiconductor &amp; Computer Engineering</span>
            </div>
	    <div id="wikichip-aheader">
		<!-- Ezoic - wikichip/global/header - top_of_page -->
		<div id="ezoic-pub-ad-placeholder-138">
                <script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <ins class="adsbygoogle" style="display:block;" data-ad-client="ca-pub-1951113009523412" data-ad-slot="1822985275" data-ad-format="auto"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
		</div>
		<!-- End Ezoic - wikichip/global/header - top_of_page -->
            </div>
</div>
<!-- wikichip-header END -->
<!-- wikichip-main-menu START -->
<ul id="wikichip-main-menu">
	<li class="btn">
        <a class="btnllnk"><i class="fa fa-home" aria-hidden="true"></i><span class="mob-collapse"> WikiChip <i class="fa fa-angle-down" aria-hidden="true"></i></span></a>
        <div class="collapse">
            <div>
                <span class="wikichip-main-menu-header">WikiChip</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5><a href="/wiki/WikiChip">WikiChip</a></h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/WikiChip">Home</a></li>
                                    <li><a href="/wiki/Special:Random?nocache=1" title="Load a random page [alt-shift-x]" accesskey="x">Random Article</a></li>
                                    <li><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [alt-shift-r]" accesskey="r">Recent Changes</a></li>
                                    <li><a href="/wiki/WikiChip:chip_feed">Chip Feed</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5><a href="https://fuse.wikichip.org/">The Fuse Coverage</a></h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://fuse.wikichip.org/">Recent News</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/isscc/">ISSCC</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/iedm/">IEDM</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/vlsi/">VLSI</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/hot-chips/">Hot Chips</a></li>
                                    <li><a href="https://fuse.wikichip.org/news/category/conferences/supercomputing/">SuperComputing</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Social Media</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="https://twitter.com/WikiChip" rel="nofollow">Twitter</a></li>
                                    <li><a href="https://flipboard.com/@WikiChip" rel="nofollow">Flipboard</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <div>
                <span class="wikichip-main-menu-header">Popular</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>Companies</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/intel">Intel</a></li>
                                    <li><a href="/wiki/amd">AMD</a></li>
                                    <li><a href="/wiki/arm_holdings">ARM</a></li>
                                    <li><a href="/wiki/qualcomm">Qualcomm</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Microarchitectures</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/intel/microarchitectures/skylake_(client)">Skylake (Client)</a></li>
                                    <li><a href="/wiki/intel/microarchitectures/skylake_(server)">Skylake (Server)</a></li>
                                    <li><a href="/wiki/amd/microarchitectures/zen">Zen</a></li>
                                    <li><a href="/wiki/intel/microarchitectures/coffee_lake">Coffee Lake</a></li>
                                    <li><a href="/wiki/amd/microarchitectures/zen_2">Zen 2</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5><a href="/wiki/technology_node">Technology Nodes</a></h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/14_nm_lithography_process">14 nm</a></li>
                                    <li><a href="/wiki/10_nm_lithography_process">10 nm</a></li>
                                    <li><a href="/wiki/7_nm_lithography_process">7 nm</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
	</li>
	<li class="btn">
        <a class="btnllnk">
            <i class="fa fa-architecture" aria-hidden="true"></i><span class="mob-collapse"> Architectures <i class="fa fa-angle-down" aria-hidden="true"></i></span></a>
        <div class="collapse">
            <div>
                <span class="wikichip-main-menu-header">Popular x86</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>Intel</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li>
                                        Client
                                        <ul>
                                            <li><a href="/wiki/intel/microarchitectures/skylake_(client)">Skylake</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/kaby_lake">Kaby Lake</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/coffee_lake">Coffee Lake</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/ice_lake_(client)">Ice Lake</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Server
                                        <ul>
                                            <li><a href="/wiki/intel/microarchitectures/skylake_(server)">Skylake</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/cascade_lake">Cascade Lake</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/cooper_lake">Cooper Lake</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/ice_lake_(server)">Ice Lake</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Big Cores
                                        <ul>
                                            <li><a href="/wiki/intel/microarchitectures/sunny_cove">Sunny Cove</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/willow_cove">Willow Cove</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Small Cores
                                        <ul>
                                            <li><a href="/wiki/intel/microarchitectures/goldmont">Goldmont</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/goldmont_plus">Goldmont Plus</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/tremont">Tremont</a></li>
                                            <li><a href="/wiki/intel/microarchitectures/gracemont">Gracemont</a></li>
                                        </ul>
                                    </li>
                                </ul>
                        </li>
                        <li>
                                <h5>AMD</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/amd/microarchitectures/zen">Zen</a></li>
                                    <li><a href="/wiki/amd/microarchitectures/zen_+">Zen+</a></li>
                                    <li><a href="/wiki/amd/microarchitectures/zen_2">Zen 2</a></li>
                                    <li><a href="/wiki/amd/microarchitectures/zen_3">Zen 3</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <div>
                <span class="wikichip-main-menu-header">Popular ARM</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>ARM</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li>
                                        Server
                                        <ul>
                                            <li><a href="/wiki/arm_holdings/microarchitectures/neoverse n1">Neoverse N1</a></li>
                                            <li><a href="/wiki/arm_holdings/microarchitectures/zeus">Zeus</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Big
                                        <ul><!--
                                            <li><a href="/wiki/arm_holdings/microarchitectures/cortex-a72">Cortex-A72</a></li>
                                            <li><a href="/wiki/arm_holdings/microarchitectures/cortex-a73">Cortex-A73</a></li>-->
					    <li><a href="/wiki/arm_holdings/microarchitectures/cortex-a75">Cortex-A75</a></li>

                                            <li><a href="/wiki/arm_holdings/microarchitectures/cortex-a76">Cortex-A76</a></li>
                                            <li><a href="/wiki/arm_holdings/microarchitectures/cortex-a77">Cortex-A77</a></li>
                                        </ul>
                                    </li>
                                    <li>
                                        Little
                                        <ul>
                                            <li><a href="/wiki/arm_holdings/microarchitectures/cortex-a53">Cortex-A53</a></li>
                                            <li><a href="/wiki/arm_holdings/microarchitectures/cortex-a55">Cortex-A55</a></li>
                                        </ul>
                                    </li>
                                </ul>
                        </li>
                        <li>
                                <h5>Cavium</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/cavium/microarchitectures/vulcan">Vulcan</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Samsung</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/samsung/microarchitectures/m1">Exynos M1</a></li>
                                    <li><a href="/wiki/samsung/microarchitectures/m2">Exynos M2</a></li>
                                    <li><a href="/wiki/samsung/microarchitectures/m3">Exynos M3</a></li>
                                    <li><a href="/wiki/samsung/microarchitectures/m4">Exynos M4</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </li>
	<li class="btn">
        <a class="btnllnk"><i class="fa fa-microchip" aria-hidden="true"></i><span class="mob-collapse"> Chips <i class="fa fa-angle-down" aria-hidden="true"></i></span></a>

        <div class="collapse">
            <div>
                <span class="wikichip-main-menu-header">Popular Families</span>
                <hr/>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>Intel</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/intel/core_i3">Core i3</a></li>
                                    <li><a href="/wiki/intel/core_i5">Core i5</a></li>
                                    <li><a href="/wiki/intel/core_i7">Core i7</a></li>
                                    <li><a href="/wiki/intel/core_i9">Core i9</a></li>
                                    <li><a href="/wiki/intel/xeon_d">Xeon D</a></li>
                                    <li><a href="/wiki/intel/xeon_e">Xeon E</a></li>
                                    <li><a href="/wiki/intel/xeon_w">Xeon W</a></li>
                                    <li><a href="/wiki/intel/xeon_bronze">Xeon Bronze</a></li>
                                    <li><a href="/wiki/intel/xeon_silver">Xeon Silver</a></li>
                                    <li><a href="/wiki/intel/xeon_gold">Xeon Gold</a></li>
                                    <li><a href="/wiki/intel/xeon_platinum">Xeon Platinum</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>AMD</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/amd/ryzen_3">Ryzen 3</a></li>
                                    <li><a href="/wiki/amd/ryzen_5">Ryzen 5</a></li>
                                    <li><a href="/wiki/amd/ryzen_7">Ryzen 7</a></li>
                                    <li><a href="/wiki/amd/ryzen_threadripper">Ryzen Threadripper</a></li>
                                    <li><a href="/wiki/amd/epyc">EPYC</a></li>
                                    <li><a href="/wiki/amd/epyc_embedded">EPYC Embedded</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <div>
                <div style="display: flex;">
                    <ul class="items">
                        <li>
                                <h5>Ampere</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/ampere_computing/emag">eMAG</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Apple</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/apple/ax">Ax</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Cavium</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/cavium/thunderx">ThunderX</a></li>
                                    <li><a href="/wiki/cavium/thunderx2">ThunderX2</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>HiSilicon</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/hisilicon/kirin">Kirin</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>MediaTek</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/mediatek/helio">Helio</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>NXP</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="">i.MX</a></li>
                                    <li><a href="">QorIQ Layerscape</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Qualcomm</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="">Snapdragon 400</a></li>
                                    <li><a href="">Snapdragon 600</a></li>
                                    <li><a href="">Snapdragon 700</a></li>
                                    <li><a href="">Snapdragon 800</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Renesas</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/renesas/r-car">R-Car</a></li>
                                </ul>
                        </li>
                        <li>
                                <h5>Samsung</h5>
                                <ul style="list-style:none; display: flex; flex-direction: column;">
                                    <li><a href="/wiki/samsung/exynos">Exynos</a></li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
	</li>

	<li class="input-search">
                <form class="mw-portlet" role="search" action="/w/index.php" id="p-search">
                        <input type="hidden" value="Special:Search" name="title"/>
                        <input type="search" name="search" class="form-control" placeholder="chip, part #, µarch, family, etc" title="Search WikiChip [alt-shift-f]" accesskey="f" id="searchInput" autocomplete="off"/>
                        <button type="submit" name="go" title="Go to the page by that name or part # if it exists"><i class="fa fa-search" aria-hidden="true"></i></button>
</form>
	</li>
</ul>
<!-- wikichip-main-menu END -->
<!-- wikichip-body-container START -->
<div class="wikichip-body-container">
<!-- mw-body-content enclosure START -->
<div id="wikichip-body-content">
<!-- mw-body-content START -->
<div class="mw-body-content">
                                <div id="siteSub">From WikiChip</div>					
<div id="article-title">
<nav id="primary_nav_wrap">
<ul>
<li><a><span class="mob-collapse"><i class="fa fa-file-o" aria-hidden="true"></i></span></a><ul><li class="selected"><a href="/wiki/mirc/msl_injection">Page</a></li></ul></li><li class=""><a href="/wiki/Talk:mirc/msl_injection"><i class="fa fa-comments" aria-hidden="true"></i></a></li>

  <li class=""><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit" title="Edit this page [alt-shift-e]" accesskey="e"><i class="fa fa-edit" aria-hidden="true"></i></a></li><li class=""><a href="/w/index.php?title=mirc/msl_injection&amp;action=history"><i class="fa fa-history" aria-hidden="true"></i></a></li>

            <li><a><i class="fa fa-user-circle-o" aria-hidden="true"></i></a><ul><li class="pt-anontalk pt-anontalk"><a href="/wiki/Special:MyTalk" title="Discussion about edits from this IP address [alt-shift-n]" accesskey="n"><i class="fa fa-users" aria-hidden="true"></i> Talk</a></li><li class="pt-anoncontribs pt-anoncontribs"><a href="/wiki/Special:MyContributions" title="A list of edits made from this IP address [alt-shift-y]" accesskey="y"><i class="fa fa-list" aria-hidden="true"></i> Contributions</a></li><li class="pt-login pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=mirc%2Fmsl+injection"><i class="fa fa-sign-in" aria-hidden="true"></i> Log in</a></li>		</ul>
	</li>



<li><a><i class="fa fa-cogs" aria-hidden="true"></i></a>
<ul>
<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/mirc/msl_injection"><i class="fa fa-map" aria-hidden="true"></i> What links here</a></li><li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/mirc/msl_injection"><i class="fa fa-list" aria-hidden="true"></i> Related changes</a></li><li id="t-print"><a href="/w/index.php?title=mirc/msl_injection&amp;printable=yes"><i class="fa fa-file-text-o" aria-hidden="true"></i> Printable version</a></li><li id="t-permalink"><a href="/w/index.php?title=mirc/msl_injection&amp;oldid=101076"><i class="fa fa-link" aria-hidden="true"></i> Permanent link</a></li><li id="t-info"><a href="/w/index.php?title=mirc/msl_injection&amp;action=info"><i class="fa fa-info-circle" aria-hidden="true"></i> Page information</a></li><li id="t-smwbrowselink"><a href="/wiki/Special:Browse/:mirc-2Fmsl-5Finjection"><i class="fa fa-tasks" aria-hidden="true"></i> Browse properties</a></li><li id="t-specialpages"><a href="/wiki/Special:SpecialPages"><i class="fa fa-certificate" aria-hidden="true"></i> Special Pages</a></li></ul>
</li>
<li><a><i class="fa fa-wheelchair" aria-hidden="true"></i></a>
  <ul>
    <li><a id="wikichip-dec-font"><img src="//en.wikichip.org/w/resources/assets/wikichip/a minus.svg" alt="Decrease Font Size" width="14"/> Decrease Size</a></li>
    <li><a id="wikichip-inc-font"><img src="//en.wikichip.org/w/resources/assets/wikichip/a plus.svg" alt="Increase Font Size" width="14"/> Increase Size</a></li>
    <li><a id="wikichip-std-font"><i class="fa fa-font" aria-hidden="true"></i> Normal Size</a></li>
  </ul>
</li>

</ul></nav>

    mSL Injection - mIRC    <span id="article-indicator"><div class="mw-indicators">
</div>
</span>
</div>


                <div id="article-breadcrumbs">
                    <span class="pull-left"><span class="subpages">&lt; <a href="/wiki/mirc" title="mirc">mirc</a></span><span class="mw-redirectedfrom">(Redirected from <a href="/w/index.php?title=MSL_Injection_-_mIRC&amp;redirect=no" class="mw-redirect" title="MSL Injection - mIRC">MSL Injection - mIRC</a>)</span></span>
                </div>	
														<p></p><div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="guidebox">
<div style="text-align: center;"><a href="/wiki/mirc" title="mirc"><span style="color: rgba(0,0,0,.53); text-shadow: 0px 2px 3px rgba(0,0,0,.33); font-size: 20pt; font-weight: bold;">mIRC</span></a></div>
<div class="header">Commands &amp; Identifiers</div>
<ul><li> <a href="/wiki/mirc/commands" title="mirc/commands">mSL Commands</a></li>
<li> <a href="/wiki/mirc/identifiers" title="mirc/identifiers">mSL Identifiers</a></li></ul>
<div class="header">Basics</div>
<ul><li> <a href="/wiki/mirc/introduction" title="mirc/introduction">Introduction</a></li>
<li> <a href="/wiki/mirc/variables" title="mirc/variables">Variables</a></li>
<li> <a href="/wiki/mirc/string_manipulation" title="mirc/string manipulation">String Manipulation</a></li>
<li> <a href="/wiki/mirc/token_manipulation" title="mirc/token manipulation">Token Manipulation</a></li>
<li> <a href="/wiki/mirc/aliases" title="mirc/aliases">Aliases</a></li></ul>
<div class="header">Events</div>
<ul><li> <a href="/wiki/mirc/on_events" title="mirc/on events">On events</a></li>
<li> <a href="/wiki/mirc/access_levels" title="mirc/access levels">Access levels</a></li>
<li> <a href="/wiki/mirc/raw_events" title="mirc/raw events">Raw Events</a></li>
<li> <a href="/wiki/mirc/ctcp_events" title="mirc/ctcp events">Ctcp Events</a></li></ul>
<div class="header">Matching Tools</div>
<ul><li> <a href="/wiki/mirc/wildcard" title="mirc/wildcard">Wildcard</a></li>
<li> <a href="/wiki/mirc/regex" title="mirc/regex">Regex</a></li></ul>
<div class="header">Data Storage</div>
<ul><li> <a href="/wiki/mirc/variables" title="mirc/variables">Variables</a></li>
<li> <a href="/wiki/mirc/file_handling" title="mirc/file handling">File Handling</a></li>
<li> <a href="/wiki/mirc/hash_tables" title="mirc/hash tables">Hash Tables</a></li>
<li> <a href="/wiki/mirc/binary_variables" title="mirc/binary variables">Binary variables</a></li>
<li> <a href="/wiki/mirc/ini_files" title="mirc/ini files">INI Files</a></li>
<li> <a href="/wiki/mirc/text_files" title="mirc/text files">Text Files</a></li></ul>
<div class="header">Control Structures</div>
<ul><li> <a href="/wiki/mirc/conditional_statements" title="mirc/conditional statements">If Then Else</a></li>
<li> <a href="/wiki/mirc/operators" title="mirc/operators">Operators</a></li>
<li> <a href="/wiki/mirc/while_loops" title="mirc/while loops">While Loops</a></li>
<li> <a href="/wiki/mirc/goto_statements" title="mirc/goto statements">Goto Loops</a></li>
<li> <a href="/wiki/mirc/groups" title="mirc/groups">Groups</a></li></ul>
<div class="header">GUI Scripting</div>
<ul><li> <a href="/wiki/mirc/custom_windows" title="mirc/custom windows">Custom Windows</a></li>
<li> <a href="/wiki/mirc/picture_windows" title="mirc/picture windows">Picture Windows</a></li>
<li> <a href="/wiki/mirc/dialogs" title="mirc/dialogs">Dialogs</a></li>
<li> <a href="/wiki/mirc/dialog_components" title="mirc/dialog components">Dialog Components</a></li></ul>
<div class="header">Sockets</div>
<ul><li> <a href="/wiki/mirc/sockets" title="mirc/sockets">Sockets</a></li>
<li> <a href="/wiki/mirc/sockets/tcp" title="mirc/sockets/tcp">TCP Sockets</a></li>
<li> <a href="/wiki/mirc/sockets/udp" title="mirc/sockets/udp">UDP Sockets</a></li></ul>
<div class="header">Advanced Scripting</div>
<ul><li> <a href="/wiki/mirc/eval_brackets" class="mw-redirect" title="mirc/eval brackets">Eval Brackets</a></li>
<li> <a href="/wiki/mirc/com" class="mw-redirect" title="mirc/com">COM</a></li>
<li> <a href="/wiki/mirc/dll" class="mw-redirect" title="mirc/dll">DLL</a></li>
<li> <a href="/wiki/mirc/sendmessage" title="mirc/sendmessage">SendMessage</a></li></ul>
<div class="header">Additional Resources</div>
<ul><li> <a href="/wiki/mirc/commands" title="mirc/commands">mSL Commands</a></li>
<li> <a href="/wiki/mirc/identifiers" title="mirc/identifiers">mSL Identifiers</a></li>
<li> <a href="/wiki/mirc/local_identifiers" title="mirc/local identifiers">mSL Local Identifiers</a></li>
<li> <a href="/wiki/mirc/on_events" title="mirc/on events">mSL Events</a></li>
<li> <a href="/wiki/mirc/access_levels#Event_prefixes" title="mirc/access levels">mSL Event Prefixes</a></li></ul>
<div class="header">Security</div>
<ul><li> <strong class="selflink">mSL Injection</strong></li>
<li> <a href="/wiki/mirc/dcc_get_security" title="mirc/dcc get security">DCC GET security</a></li></ul>
<div class="header">Other</div>
<ul><li> <a href="/wiki/mirc/mirc_installation" title="mirc/mirc installation">mIRC Installation</a></li>
<li> <a href="/wiki/mirc/virtual_profile" title="mirc/virtual profile">Virtual profile</a></li>
<li> <a href="/wiki/mirc/playing_music" title="mirc/playing music">Playing music</a></li>
<li> <a href="/wiki/mirc/unicode" title="mirc/unicode">Unicode</a></li>
<li> <a href="/wiki/mirc/ipv6" title="mirc/ipv6">IPv6</a></li>
<li> <a href="/wiki/mirc/optimization" title="mirc/optimization">Optimization</a></li>
<li> <a href="/wiki/mirc/thread" title="mirc/thread">Threads</a></li>
<li> <a href="/wiki/mirc/dcc_protocols" title="mirc/dcc protocols">DCC Protocols</a></li>
<li> <a href="/w/index.php?title=mirc/line_length_limit&amp;action=edit&amp;redlink=1" class="new" title="mirc/line length limit (page does not exist)">Line Length Limit</a></li>
<li> <a href="/w/index.php?title=mirc/font_rendering&amp;action=edit&amp;redlink=1" class="new" title="mirc/font rendering (page does not exist)">Font rendering</a></li></ul>
<div></div><span class="noprint plainlinks navbar" style="float:right;"><small><span style="white-space:nowrap;word-spacing:-.12em;"><a href="/wiki/Template:mirc_guide" title="Template:mirc guide"><span style="" title="View this template">v</span></a><span style=""> <b>·</b> </span><a href="/wiki/Template:mirc_guide" title="Template:mirc guide"><span style="" title="Discuss this template">d</span></a><span style=""> <b>·</b> </span><a rel="nofollow" class="external text" href="/w/index.php?title=Template:mirc_guide&amp;action=edit"><span style="" title="Edit this template">e</span></a></span></small></span>
</div>
<p><b>mSL injection</b> (mIRC Scripting Language injection) is a code injection technique that exploits mIRC&#39;s ability to dynamically evaluate code on the run. With mSLs powerful commands and identifiers, the result of a code injection attack can be disastrous. It is important that you understand what to look for when working with vulnerable commands.
</p><p>This tutorial will try to summarize for you what commands are problematic, how to detect it, and how to fix it. 
</p><p>An eval injection vulnerability consists of two things: 
</p>
<ul><li> A script that evaluates a code (via a vulnerable command/ident)</li>
<li> User input that is not properly validated</li></ul>
<p>Injections happen because of a simple side effect of the main rules definiting the syntaxes/semantics of the language.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Injection_via_commands"><span class="tocnumber">1</span> <span class="toctext">Injection via commands</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Nested_command"><span class="tocnumber">1.1</span> <span class="toctext">Nested command</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#The_.2Ftimer_command"><span class="tocnumber">1.1.1</span> <span class="toctext">The /timer command</span></a>
<ul>
<li class="toclevel-4 tocsection-4"><a href="#.24chan.2F.23"><span class="tocnumber">1.1.1.1</span> <span class="toctext">$chan/#</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-5"><a href="#.2Fscon_and_.2Fscid"><span class="tocnumber">1.1.2</span> <span class="toctext">/scon and /scid</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#.2Fdde"><span class="tocnumber">1.1.3</span> <span class="toctext">/dde</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#.2Fflash"><span class="tocnumber">1.2</span> <span class="toctext">/flash</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Injection_via_.24identifiers"><span class="tocnumber">2</span> <span class="toctext">Injection via $identifiers</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#.24readini.28.29_and_.24read.28.29"><span class="tocnumber">2.1</span> <span class="toctext">$readini() and $read()</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#.24submenu"><span class="tocnumber">2.2</span> <span class="toctext">$submenu</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#.24calc.28.29"><span class="tocnumber">2.3</span> <span class="toctext">$calc()</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#.24decode"><span class="tocnumber">2.4</span> <span class="toctext">$decode</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#.24findfile_.24finddir_.24hfind_.24dllcall_etc"><span class="tocnumber">2.5</span> <span class="toctext">$findfile $finddir $hfind $dllcall etc</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#Injection_via_Bugs"><span class="tocnumber">3</span> <span class="toctext">Injection via Bugs</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#.24iif.28_.28cond.29_.2Fcmd.2C_true.2C_false_.29"><span class="tocnumber">3.1</span> <span class="toctext">$iif( (cond) /cmd, true, false )</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="#Injection_via_mIRC_configuration"><span class="tocnumber">4</span> <span class="toctext">Injection via mIRC configuration</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Injection_via_server_command"><span class="tocnumber">5</span> <span class="toctext">Injection via server command</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Injection_via_commands">Injection via commands</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=1" title="Edit section: Injection via commands">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>For a command, the interesting rule used by the parser to make it working is to evaluate $identifiers and %variables once before passing their value to the command:
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$me" title="$me - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$me</span></a></span></pre>
<p>Here <a href="/wiki/mirc/identifiers/$me" title="mirc/identifiers/$me">$me</a> is evaluated, then -a is passed as the first parameter and the value of <a href="/wiki/mirc/identifiers/$me" title="mirc/identifiers/$me">$me</a> is passed as the second parameter to the /echo command.
</p>
<h2><span class="mw-headline" id="Nested_command">Nested command</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=2" title="Edit section: Nested command">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Now, the language features some commands where one or more of their parameters are actually meant to be a new command with its own parameters. That new command is meant to be used later automatically by mIRC, this is where the injection happens.
</p><p>Any command like this suffers the problem, we also refer to this problem as the double evaluation problem. They are fortunately not a lot of these commands, here is a list:
</p>
<ul><li> /timer</li>
<li> /scon</li>
<li> /scid</li>
<li> /dde</li></ul>
<h3><span class="mw-headline" id="The_.2Ftimer_command">The /timer command</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=3" title="Edit section: The /timer command">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Perhaps the most problematic command of them all is the /timer command. The /timer command is used to delay the execution of another command (it has others features but this is the interesting one).
</p><p>Because of this, you must pass a new command to be executed after the delay to the timer command:
</p>
<pre><span class="code_line">//.timer 1 1 echo -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$day" title="$day - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$day</span></a></span></pre>
<p>Which will execute &#34;echo -a &lt;value of <a href="/wiki/mirc/identifiers/$day" title="mirc/identifiers/$day">$day</a>&gt;&#34; one time, after waiting 1 second.
</p><p>What happens here is that the parameters passed to the /timer command are evaluated once as we saw, so <a href="/wiki/mirc/identifiers/$day" title="mirc/identifiers/$day">$day</a> gets evaluated once, producing the current day.
</p><p>The timer will register that its associated command to be executed when the delay has passed is &#34;echo -a &lt;<a href="/wiki/mirc/identifiers/$day" title="mirc/identifiers/$day">$day</a>&#39;s value&gt;&#34;
</p><p>When the timer fires, its command (a new command) is executed and therefore all of its parameters are, once again, evaluated one time. In this example there is no problem and we can&#39;t see the difference because <a href="/wiki/mirc/identifiers/$day" title="mirc/identifiers/$day">$day</a> can only return a day of the week. If <a href="/wiki/mirc/identifiers/$day" title="mirc/identifiers/$day">$day</a> is monday, evaluating the plain text monday will always produce monday.
</p><p>But what if we didn&#39;t have $day? what if we had something like $2? Let&#39;s consider a more useful example, an innocent reminder script:
</p>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!reminder &amp; *:#:<span class="mirc_bracket">{</span></span>
<span class="code_line"> <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a> !isnum<span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/notice" title="/notice - mIRC Command" style="text-decoration: none"><span class="mirc_command">    notice</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> [Reminder] Syntax Error: !reminder &lt;seconds&gt; &lt;message&gt;</span>
<span class="code_line">    <span class="mirc_control">return</span></span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/timer" title="/timer - mIRC Command" style="text-decoration: none"><span class="mirc_command">  .timer</span></a> 1 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a> notice <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> [Reminder] <a href="http://en.wikichip.org/wiki/mirc/identifiers/$3" title="$3 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$3</span></a>- <span class="mirc_bracket">(</span>Set <a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a> seconds ago<span class="mirc_bracket">)</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<p>When the correct input is provided, this script works wonderfully. For example:
</p>
<pre>&lt;Mike&gt; !reminder 18000 jill&#39;s birthday tomorrow!
-Bot- [Reminder] jill&#39;s birthday tomorrow! (Set 18000 seconds ago)</pre>
<p>Indeed, /timer evaluated the parameter once: $2 is evaluated to 18000 and $3- to &#34;jill&#39;s birthday tomorrow!&#34;
</p><p>The associated command of the timer is correctly <code>notice Mike [Reminder] jill&#39;s birthday tomorrow! (Set 18000 seconds ago)</code>, when the timer fires, the /notice command will see its parameters evaluated once, but there is nothing to evaluate in this case.
</p><p>Although this script might seem simple, let&#39;s take a look at what happens when someone provides incorrect or even malicious input as in this case:
</p>
<pre>&lt;Mike&gt; !reminder 0 . | ns drop nick | quit hacked!
-Bot- [Reminder] . (Set 0 seconds ago)
* Bot (~Bot@isp.example.com) Quit (Quit: hacked!)</pre>
<p>This is an msl injection attack. Let&#39;s take a deeper look into what has happened:
</p><p>As we know, /timer evaluated the parameter once; $2 is evaluated to <code>0</code> and $3- is evaluated to <code>. | ns drop nick | quit hacked!</code>
</p><p>So now, the associated command of the timer becomes <code>.notice Mike [Reminder] . | ns drop nick | quit hacked!</code> and you might be recognizing the pipe character, used to separate commands, which mIRC will interpret as such, resulting in /ns drop nick and /quit hacked! being executed.
</p><p>Clearly, you can see how the timer command can be extremely dangerous. The unfortunate part is that there is no clean way of solving this problem. The only way to prevent this from happening is to encode the problematic parameters so that when they get evaluated, they produce something which needs one more evaluation to produce the correct value. We usually do that by encoding the parameters using based64 encoding. Below is an alias to perform this:
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/aliases" title="Aliases - mIRC" style="text-decoration: none;"><span class="mirc_control">alias</span></a> <em>safe</em> <span class="mirc_control">return</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$!" title="$! - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$!</span></a>decode<span class="mirc_bracket">(</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>-, m<span class="mirc_bracket">)</span> ,m<span class="mirc_bracket">)</span></span></pre>
<p>The spacing is very important. Our new !reminder script now looks like this:
</p>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!reminder &amp; *:#:<span class="mirc_bracket">{</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a> !isnum<span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/notice" title="/notice - mIRC Command" style="text-decoration: none"><span class="mirc_command">    notice</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> [Reminder] Syntax Error: !reminder &lt;seconds&gt; &lt;message&gt;</span>
<span class="code_line">    <span class="mirc_control">return</span></span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/timer" title="/timer - mIRC Command" style="text-decoration: none"><span class="mirc_command">  .timer</span></a> 1 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a> notice <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> [Reminder] <a href="http://en.wikichip.org/wiki/mirc/identifiers/$safe" title="$safe - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$safe</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$3" title="$3 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$3</span></a>-<span class="mirc_bracket">)</span> <span class="mirc_bracket">(</span>Set <a href="http://en.wikichip.org/wiki/mirc/identifiers/$safe" title="$safe - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$safe</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a><span class="mirc_bracket">)</span> seconds ago<span class="mirc_bracket">)</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<p>Let&#39;s take a look at what happens now:
</p>
<pre>&lt;Mike&gt; !reminder 0 . | ns drop nick | quit hacked!
-Bot- [Reminder] . | ns drop nick | quit hacked! (Set 0 seconds ago)</pre>
<p>And Mike now can&#39;t do anything harmful.
</p><p>/timer will evaluate the parameter as we know but this time, $safe($3-) where $3- is <code>. | ns drop nick | quit hacked!</code> is evaluated to <code><a href="/wiki/mirc/identifiers/$decode" title="mirc/identifiers/$decode">$decode</a>( LiB8IG5zIGRyb3AgbmljayB8IHF1aXQgaGFja2VkIQ== ,m)</code> and $safe($2) to <code><a href="/wiki/mirc/identifiers/$decode" title="mirc/identifiers/$decode">$decode</a>( MTgwMDA= ,m)</code>.
</p><p>The command associated with the timer now becomes <code><a href="/wiki/mirc/commands/notice" title="mirc/commands/notice">/notice</a> Mike [Reminder] <a href="/wiki/mirc/identifiers/$decode" title="mirc/identifiers/$decode">$decode</a>( LiB8IG5zIGRyb3AgbmljayB8IHF1aXQgaGFja2VkIQ== ,m) (Set <a href="/wiki/mirc/identifiers/$decode" title="mirc/identifiers/$decode">$decode</a>( MTgwMDA= ,m) seconds ago)</code> and those <a href="/wiki/mirc/identifiers/$decode" title="mirc/identifiers/$decode">$decode</a>, when evaluated once by <a href="/wiki/mirc/commands/notice" title="mirc/commands/notice">/notice</a>, will produce the correct result (the original input of Mike).
</p><p>Now you don&#39;t need to do that for any <a href="/wiki/mirc/commands/timer" title="mirc/commands/timer">/timer</a> command of course, only when the parameter is unknown at the time you are writing the script, such as $2 and $3- here.
</p><p><b>Note</b>: Since mIRC 7.44, an $unsafe identifier has been added which behaves just like $safe (the name was changed to unsafe to avoid misleading new users), delaying the execution of one level.
</p>
<h5><span class="mw-headline" id=".24chan.2F.23">$chan/#</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=4" title="Edit section: $chan/#">edit</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>You may think <a href="/wiki/mirc/identifiers/$chan" title="mirc/identifiers/$chan">$chan</a> can&#39;t be evaluated in an malicious way but that&#39;s not true, if the <a href="/wiki/mirc/identifiers/$chan" title="mirc/identifiers/$chan">$chan</a> (also #) identifier is unknown, you should encode it as well.
</p><p>The reason for this is mIRC allows prefixing an identifier with the pound sign to make mIRC prefixes (if needed) the evaluated string by the pound symbol. For example:
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/tokenize" title="/tokenize - mIRC Command" style="text-decoration: none"><span class="mirc_command">//tokenize</span></a> 32 A #B |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a #<a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a> #<a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a></span></pre>
<p>This will produce the following result:
</p>
<pre><span class="code_line">#A #B</span></pre>
<p>So what does that have to do with <a href="/wiki/mirc/identifiers/$chan" title="mirc/identifiers/$chan">$chan</a> and timers? Everything! 
</p><p>Consider the following bot&#39;s code:
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/aliases" title="Aliases - mIRC" style="text-decoration: none;"><span class="mirc_control">alias</span></a> <em>bot_pass</em> <span class="mirc_control">return</span> foo_bar_42</span>
<span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">connect</span>:<span class="mirc_bracket">{</span>  </span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/autojoin" title="/autojoin - mIRC Command" style="text-decoration: none"><span class="mirc_command">  autojoin</span></a> -d5  </span>
<span class="code_line">  ns id <a href="http://en.wikichip.org/wiki/mirc/identifiers/$bot_pass" title="$bot_pass - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$bot_pass</span></a></span>
<span class="code_line"><span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">invite</span>:#:join #</span>
<span class="code_line"><span class="mirc_control">on</span> !*:<span class="mirc_control">join</span>:#:<span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/timer" title="/timer - mIRC Command" style="text-decoration: none"><span class="mirc_command">  timer</span></a> 1 2 notice <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> Hello <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> , Welcome to # <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> !</span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<p>Everything works just fine under normal conditions. But Mike knows better than to test things under normal conditions:
</p>
<pre>* Now talking in #$($bot_pass)
/invite foobar #$($bot_pass)
* Bot joined #$($bot_pass)
/hop #$($bot_pass)
* Attempting to rejoin channel #$($bot_pass)
* Rejoined channel #$($bot_pass)
-Bot- Hello Mike, Welcome to foo_bar_42</pre>
<p>Because <a href="/wiki/mirc/identifiers/$chan" title="mirc/identifiers/$chan">$chan</a> (or #) was not escaped, it was evaluated. Mike was able to evaluate the $bot_pass alias and get the bot&#39;s password.
</p><p>You might want to watch out for <a href="/wiki/mirc/identifiers/$nick" title="mirc/identifiers/$nick">$nick</a> as well, some servers allow nicknames to have the &#39;$&#39; character.
</p>
<h3><span class="mw-headline" id=".2Fscon_and_.2Fscid">/scon and /scid</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=5" title="Edit section: /scon and /scid">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Both of these commands were created to evaluate/execute code on a given connection. Just like the <a href="/wiki/mirc/commands/timer" title="mirc/commands/timer">/timer</a> command, any unknown content must be escaped somehow.
</p><p>Though, unlike <a href="/wiki/mirc/commands/timer" title="mirc/commands/timer">/timer</a>, the <a href="/wiki/mirc/commands/scid" title="mirc/commands/scid">/scid</a> and <a href="/wiki/mirc/commands/scon" title="mirc/commands/scon">/scon</a> are so that when their associated command triggers, they are able to evaluate local variables (but they can&#39;t evaluate local identifier like $1-), which makes the escaping easier, you can use the $safe method, but you can simply just use a local variable, consider this less practical example:
</p>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!global *:#:<span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/scon" title="/scon - mIRC Command" style="text-decoration: none"><span class="mirc_command">  scon</span></a> -at1 amsg [AMSG] <a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>-</span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<p>The script is designed to do a global amsg (i.e. perform an <a href="/wiki/mirc/commands/amsg" title="mirc/commands/amsg">/amsg</a> on every active connection). Just like the timer command, $1- will be evaluated again in the specified connection when the associated command of <a href="/wiki/mirc/commands/scon" title="mirc/commands/scon">/scon</a> triggers (/amsg [AMSG] $1-), which means any user code will become part of your bot&#39;s code.
</p>
<ul><li> $safe solution:</li></ul>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!global *:#:<span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/scon" title="/scon - mIRC Command" style="text-decoration: none"><span class="mirc_command">  scon</span></a> -at1 amsg [AMSG] <a href="http://en.wikichip.org/wiki/mirc/identifiers/$safe" title="$safe - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$safe</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>-<span class="mirc_bracket">)</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<ul><li> Local variable solution:</li></ul>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!global *:#:<span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">  var</span></a> <span class="mirc_variable">%a</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a>-</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/scon" title="/scon - mIRC Command" style="text-decoration: none"><span class="mirc_command">  scon</span></a> -at1 amsg [AMSG] % <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> a</span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<p>The associated command becomes <code>amsg [AMSG] %a</code> and %a is evaluated correctly to produce the user&#39;s message.
</p><p><b>Note</b>: /scid and /scon can be used to change the current connection only, in this case you can just execute the command normally after, does not work for /scon -a for example.
</p>
<h3><span class="mw-headline" id=".2Fdde">/dde</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=6" title="Edit section: /dde">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>/dde has the same issue and the same solution as /timer, just use $safe on the problematic parameters.
</p>
<h2><span class="mw-headline" id=".2Fflash">/flash</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=7" title="Edit section: /flash">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Though /flash is the only command doing it for now, more command might do this in the future. <a href="/wiki/mirc/commands/flash" title="mirc/commands/flash">/flash</a> does not take a new command as one of its parameter but it can take a text as an optional parameter, to be used automatically later, that text will be evaluated once by <a href="/wiki/mirc/commands/flash" title="mirc/commands/flash">/flash</a>, and mIRC will also evaluate the text parameter once when applying the flash:
</p>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!testflash:#:/flash $ <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> me</span></pre>
<p>So $ $+ me evaluates to &#34;<a href="/wiki/mirc/identifiers/$me" title="mirc/identifiers/$me">$me</a>&#34; by <a href="/wiki/mirc/commands/flash" title="mirc/commands/flash">/flash</a>, and $me will be evaluated to your nickname (that text appears in mIRC&#39;s titlebar).
</p><p>The $safe solution must be used there.
</p>
<h1><span class="mw-headline" id="Injection_via_.24identifiers">Injection via $identifiers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=8" title="Edit section: Injection via $identifiers">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id=".24readini.28.29_and_.24read.28.29">$readini() and $read()</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=9" title="Edit section: $readini() and $read()">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>If you have visited #mSL on swiftirc, and you had some code that used <a href="/wiki/mirc/identifiers/$read" title="mirc/identifiers/$read">$read()</a> or <a href="/wiki/mirc/identifiers/$readini" title="mirc/identifiers/$readini">$readini()</a> without the n switch you would most likely had people yelling at you to always use it. But why? The reason is:
</p>
<pre><b>By default BOTH $read() and $readini() treat the text in the file as code!</b>
</pre>
<p>So what are some of its consequences? Consider the following greet script:
</p>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!setgreet*:#:<span class="mirc_bracket">{</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span>!<a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a>-<span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span><a href="http://en.wikichip.org/wiki/mirc/commands/notice" title="/notice - mIRC Command" style="text-decoration: none"><span class="mirc_command"> notice</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> Syntax Error: !setgreet &lt;greet&gt; | <span class="mirc_control">return</span> <span class="mirc_bracket">}</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/writeini" title="/writeini - mIRC Command" style="text-decoration: none"><span class="mirc_command">  writeini</span></a> greets.ini greet <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a>-</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/notice" title="/notice - mIRC Command" style="text-decoration: none"><span class="mirc_command">  notice</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> [Greet] Greet Saved.</span>
<span class="code_line"><span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_control">on</span> !*:<span class="mirc_control">join</span>:#:<span class="mirc_bracket">{</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$readini" title="$readini - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$readini</span></a><span class="mirc_bracket">(</span>greets.ini, greet, <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a><span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/msg" title="/msg - mIRC Command" style="text-decoration: none"><span class="mirc_command">    msg</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a> [[ <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> ] <a href="http://en.wikichip.org/wiki/mirc/identifiers/$v1" title="$v1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$v1</span></a></span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<p>Let&#39;s see what happens:
</p>
<pre>&lt;Mike&gt; !setgreet
-Bot- Syntax Error: !setgreet &lt;greet&gt;
&lt;Mike&gt; !setgreet Two things are certain in life, death and taxes. - Benjamin Franklin
-Bot- [Greet] Greet Saved.
/hop
* Rejoined channel #foobar
&lt;Bot&gt; [foobar] Two things are certain in life, death and taxes. - Benjamin Franklin
&lt;Mike&gt; !setgreet Hello $findfile(C:\, *, 1, quit hacked!)
-Bot- [Greet] Greet Saved.
/hop
* Rejoined channel #foobar
* Bot (~Bot@isp.example.com) Quit (Quit: hacked!)</pre>
<p>In this example Mike used the fact that <a href="/wiki/mirc/identifiers/$findfile" title="mirc/identifiers/$findfile">$findfile()</a> can execute a command when it finds a matching file. It should be clear how dangerous this can be. 
</p><p>So how do we fix it? Using the <b>n</b> option!
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/identifiers/$read" title="$read - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$read</span></a><span class="mirc_bracket">(</span>... , n, ...<span class="mirc_bracket">)</span></span>
<span class="code_line"><span class="mirc_comment">;and </span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/identifiers/$readini" title="$readini - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$readini</span></a><span class="mirc_bracket">(</span>..., n, ...<span class="mirc_bracket">)</span></span></pre>
<p>Our new code would look like this:
</p>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!setgreet*:#:<span class="mirc_bracket">{</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span>!<a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a>-<span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span><a href="http://en.wikichip.org/wiki/mirc/commands/notice" title="/notice - mIRC Command" style="text-decoration: none"><span class="mirc_command"> notice</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> Syntax Error: !setgreet &lt;greet&gt; | <span class="mirc_control">return</span> <span class="mirc_bracket">}</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/writeini" title="/writeini - mIRC Command" style="text-decoration: none"><span class="mirc_command">  writeini</span></a> greets.ini greet <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a>-</span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/notice" title="/notice - mIRC Command" style="text-decoration: none"><span class="mirc_command">  notice</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> [Greet] Greet Saved.</span>
<span class="code_line"><span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_control">on</span> !*:<span class="mirc_control">join</span>:#:<span class="mirc_bracket">{</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$readini" title="$readini - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$readini</span></a><span class="mirc_bracket">(</span>greets.ini, n, greet, <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a><span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/msg" title="/msg - mIRC Command" style="text-decoration: none"><span class="mirc_command">    msg</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chan" title="$chan - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chan</span></a> [[ <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> ] <a href="http://en.wikichip.org/wiki/mirc/identifiers/$v1" title="$v1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$v1</span></a></span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<h2><span class="mw-headline" id=".24submenu">$submenu</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=10" title="Edit section: $submenu">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The value returned by the alias called by $submenu is evaluated a second time, again, $safe and similar methods are your friend:
</p>
<pre><span class="code_line"><span class="mirc_control">menu</span> menubar <em></em> <span class="mirc_bracket">{</span></span>
<span class="code_line">  double evaluation</span>
<span class="code_line">  .<a href="http://en.wikichip.org/wiki/mirc/identifiers/$submenu" title="$submenu - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$submenu</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$testsm" title="$testsm - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$testsm</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a><span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/aliases" title="Aliases - mIRC" style="text-decoration: none;"><span class="mirc_control">alias</span></a> <em>testsm</em> <span class="mirc_bracket"><span class="mirc_bracket">{</span></span></span>
<span class="code_line"><span class="mirc_control">if</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a> == 1<span class="mirc_bracket">)</span> <span class="mirc_control">return</span> item : echo -ag &gt; $!!me</span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<h2><span class="mw-headline" id=".24calc.28.29">$calc()</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=11" title="Edit section: $calc()">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>ALL unknown (in advance) input to <a href="/wiki/mirc/identifiers/$calc" title="mirc/identifiers/$calc">$calc</a> should be validated. $calc has its own special evaluation routine, it possesses the ability to double evaluate variables and identifier if their value returns a %variable. Consider the following code:
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> <span class="mirc_variable">%x</span> = 12345 |<a href="http://en.wikichip.org/wiki/mirc/commands/tokenize" title="/tokenize - mIRC Command" style="text-decoration: none"><span class="mirc_command"> tokenize</span></a> 32 % <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> x |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a> = <a href="http://en.wikichip.org/wiki/mirc/identifiers/$calc" title="$calc - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$calc</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$1" title="$1 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$1</span></a><span class="mirc_bracket">)</span></span></pre>
<p>Which will produce the following result: 
</p>
<pre>%x = 12345
</pre>
<p><b>Surprise!</b> We bet you did not expect that to happen. (This is actually a side effect of <a href="/wiki/mirc/identifiers/$calc" title="mirc/identifiers/$calc">$calc</a> being able to evaluate variables inside parenthesis or immediately after an operator without a space.) 
</p><p>Now let&#39;s take a look at a more practical example:
</p>
<pre><span class="code_line"><span class="mirc_comment">; Assume <span class="mirc_variable">%password</span> is set to 123456</span></span>
<span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">connect</span>:<span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/autojoin" title="/autojoin - mIRC Command" style="text-decoration: none"><span class="mirc_command">  autojoin</span></a> -d5</span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$network" title="$network - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$network</span></a> == UnderNet<span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/msg" title="/msg - mIRC Command" style="text-decoration: none"><span class="mirc_command">    msg</span></a> x@channels.undernet.org login Wiz126 <span class="mirc_variable">%password</span></span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!calc *:#:<span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/msg" title="/msg - mIRC Command" style="text-decoration: none"><span class="mirc_command">  msg</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> [Calc] <a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a>- = <a href="http://en.wikichip.org/wiki/mirc/identifiers/$calc" title="$calc - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$calc</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a>-<span class="mirc_bracket">)</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<p>Like most people, this user has an on connect event to register his user and a simple !calc script. 
</p><p>Let&#39;s see what Mike can do to him:
</p>
<pre>&lt;Mike&gt; !calc 3*5+55
&lt;Wiz126&gt; [Calc] 3*5+55 = 70
&lt;Mike&gt; !calc %password
&lt;Wiz126&gt; [Calc] %password = 123456</pre>
<p>It&#39;s clear how Mike was able to get the value of a pretty important variable. 
</p><p>It&#39;s important to note that EVEN if %password was set to &#34;1234rosebud&#34;. The $calc() will return &#34;1234&#34;, which is not the whole password but it&#39;s a big chunk of it.
</p><p>A simple way to prevent this from happening with such a script is to restrict the usage to input which do not contain identifiers and %variables:
</p>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">text</span>:!calc *:#:<span class="mirc_bracket">{</span></span>
<span class="code_line">  <span class="mirc_control">if</span> <span class="mirc_bracket">(</span>!<a href="http://en.wikichip.org/wiki/mirc/identifiers/$regex" title="$regex - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$regex</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a>-,/\$\S+|%\S+/<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span> <span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/msg" title="/msg - mIRC Command" style="text-decoration: none"><span class="mirc_command">    msg</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> [Calc] <a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a>- = <a href="http://en.wikichip.org/wiki/mirc/identifiers/$calc" title="$calc - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$calc</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$2" title="$2 - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$2</span></a>-<span class="mirc_bracket">)</span></span>
<span class="code_line">  <span class="mirc_bracket">}</span></span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<h2><span class="mw-headline" id=".24decode">$decode</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=12" title="Edit section: $decode">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This is not really an exploit, but is a way for someone to disguise their malicious command. It can&#39;t be executed except by someone taking advantage of the $iif() bug below, or else as part of a script. When a /command is typed in a channel editbox, it will not let anything be executed if it&#39;s a command which begins with a % or a $, but that behavior does not extend to remote scripts.
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> <span class="mirc_variable">%cmd</span> echo | [ <span class="mirc_variable">%cmd</span> ] 4 -a hello world</span></pre>
<p>Pasting the above command into an editbox echoes &#39;hello world&#39; to the active window in red text. However it won&#39;t work if the square braces are removed, because the command beginning with % halts the editbox command, but doesn&#39;t halt the same thing in a remote script.
</p><p>Something similar can be done with $decode, but it only works if $decode(string) is placed somewhere which allows its contents to be evaluated/executed, which includes the $iif bug, placing into a timer&#39;s command line, inside square braces, etc. Below shows how the decode string is created, but the echo command is NOT executed by $decode, but by the fact that the decoded string is placed into the timer&#39;s command string. If the &#34;timer 1 1&#34; had not been there, this would have executed the echo command if it were inside a remote script, but would not have executed in the editbox simply because the editbox doesn&#39;t execute commands beginning with % or $.
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> -s <span class="mirc_variable">%a</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$remove" title="$remove - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$remove</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$encode" title="$encode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$encode</span></a><span class="mirc_bracket">(</span>echo 4 -a hello world,m<span class="mirc_bracket">)</span>,=<span class="mirc_bracket">)</span> |<a href="http://en.wikichip.org/wiki/mirc/commands/timer" title="/timer - mIRC Command" style="text-decoration: none"><span class="mirc_command"> timer</span></a> 1 1 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span>ZWNobyA0IC1hIGhlbGxvIHdvcmxk,m<span class="mirc_bracket">)</span></span></pre>
<h2><span class="mw-headline" id=".24findfile_.24finddir_.24hfind_.24dllcall_etc">$findfile $finddir $hfind $dllcall etc</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=13" title="Edit section: $findfile $finddir $hfind $dllcall etc">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This category relates to identifiers who have a &#39;command parm&#39; or a &#39;callback alias&#39; where a malicious command could be placed. It&#39;s harder for $hfind and $dllcall to be exploited, because they require knowing the name of an existing hashtable or the pathname to a dll file. However, there&#39;s always at least 1 filename in the $mircdir folder, so the following /noop command can be used to execute the encoded echo command contained in $findfile&#39;s command parm. Again, the $decode command is not executing the command, it&#39;s just disguising the command that has been placed into a location which executes code placed there. The following 3 commands are doing the exact same thing, with the only difference being that $decode is hiding what the payload command actually is.
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command">//noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$findfile" title="$findfile - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$findfile</span></a><span class="mirc_bracket">(</span>.,*,1, <a href="http://en.wikichip.org/wiki/mirc/identifiers/$decode" title="$decode - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$decode</span></a><span class="mirc_bracket">(</span>ZWNobyA0IC1hIGhlbGxvIHdvcmxk,m<span class="mirc_bracket">)</span> <span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command">//noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$findfile" title="$findfile - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$findfile</span></a><span class="mirc_bracket">(</span>.,*,1, <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a><span class="mirc_bracket">(</span>echo 4 -a hello world<span class="mirc_bracket">)</span> <span class="mirc_bracket">)</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/noop" title="/noop - mIRC Command" style="text-decoration: none"><span class="mirc_command">//noop</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$findfile" title="$findfile - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$findfile</span></a><span class="mirc_bracket">(</span>.,*,1, echo 4 -a hello world <span class="mirc_bracket">)</span></span></pre>
<h1><span class="mw-headline" id="Injection_via_Bugs">Injection via Bugs</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=14" title="Edit section: Injection via Bugs">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>There are currently a few bugs in mIRC that allow for mSL injection, most in a round-a-bout fashion
</p>
<h2><span class="mw-headline" id=".24iif.28_.28cond.29_.2Fcmd.2C_true.2C_false_.29">$iif( (cond) /cmd, true, false )</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=15" title="Edit section: $iif( (cond) /cmd, true, false )">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Due to the way mIRC handles <a href="/wiki/mirc/identifiers/$iif" title="mirc/identifiers/$iif">$iif()</a> statements, by wrapping a condition in parens and then appending a command, mIRC will execute/eval the command/identifier.
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command">//echo</span></a> -a <a href="http://en.wikichip.org/wiki/mirc/identifiers/$iif" title="$iif - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$iif</span></a><span class="mirc_bracket">(</span> <span class="mirc_bracket">(</span>1<span class="mirc_bracket">)</span><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a See what I mean, truthy, falsey<span class="mirc_bracket">)</span></span></pre>
<p>The above will echo &#34;See what I mean <a href="/wiki/mirc/commands/return" title="mirc/commands/return">/!return 1</a>&#34;, and neither the truthy or falsey statements are returned nor is the outter echo statement executed.
This is happening because internally, <a href="/wiki/mirc/identifiers/$iif" title="mirc/identifiers/$iif">$iif</a> is calling the /if construct in the following way:
</p>
<pre><span class="code_line"> //<span class="mirc_control">if</span> <span class="mirc_bracket">(</span>condition<span class="mirc_bracket">)</span> !<span class="mirc_control">return</span> 1 | !<span class="mirc_control">return</span> 0</span></pre>
<p>which gives:
</p>
<pre><span class="code_line"> //<span class="mirc_control">if</span> <span class="mirc_bracket">(</span> <span class="mirc_bracket">(</span>1<span class="mirc_bracket">)</span><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a See what I mean<span class="mirc_bracket">)</span> !<span class="mirc_control">return</span> 1 | !<span class="mirc_control">return</span> 0</span></pre>
<p>And the quirk is there, this syntax actually executes the echo command.
</p><p>The abuse of this is limited as the user of mIRC would either have to code the malformed $iif() statement or be tricked into issuing it from something such as the editbox. Be careful!
</p>
<h1><span class="mw-headline" id="Injection_via_mIRC_configuration">Injection via mIRC configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=16" title="Edit section: Injection via mIRC configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>You should inspect your mIRC settings for certain things which can be used to exploit you. If you check these things, you can help defend against some exploits which depend on a combination of factors, where just severing 1 link in the chain prevents the exploit.<br/>
</p><p>First, check the Options menu of your Alt+R scripts editor. It&#39;s a good idea set a few options here which can prevent problems.
</p>
<ol><li> Identifier warning</li></ol>
<p>This halts a script when an invalid identifier name is used, rather than evaluating the identifier as $null. The error warning can alert you to a script error which can cause it to not do as you expect.
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/aliases" title="Aliases - mIRC" style="text-decoration: none;"><span class="mirc_control">alias</span></a> <em>identwarntest</em> <span class="mirc_bracket"><span class="mirc_bracket">{</span></span></span>
<span class="code_line">  <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nosuchidentifier" title="$nosuchidentifier - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nosuchidentifier</span></a> echo -a hello world</span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<p>If you do not have identifier warning, and the above identifier is the mis-typing of an identifier which was supposed to return either &#34;echo -a&#34; or &#34;notice $nick&#34; or &#34;msg #channel&#34;, then without identifier warning being checked, that identifier evaluates to $null, causing the remainder of the command to be executed. If the 1st word is not a valid command, mIRC sends the command to a server in case that&#39;s a valid server command, which makes it possible to leak sensitive info in some cases. By halting the script with an identifier warning, this gives a chance to fix your script.
</p>
<ol><li> Initialization Warning</li></ol>
<p>This warns if the /load command or the script-editor&#39;s /file/open has loaded a script containing :START&#34; or :LOAD: events which would execute code immediately. This still doesn&#39;t defend against scripts containing :TEXT: or other events which could be triggered *later*, and doesn&#39;t defend if /reload was used instead of /load.
</p>
<ol><li> Monitor File Changes</li></ol>
<p>This warns if a loaded script has changed without being changed by the scripts editor itself. Sometimes it can be caused by your editing scripts in a 3rd party editor such as notepad, but it could also be caused by a script using /write to alter itself or a different script.
</p>
<ul><li> It&#39;s possible to have a script loaded that you don&#39;t realize.</li></ul>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/write" title="/write - mIRC Command" style="text-decoration: none"><span class="mirc_command">//write</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>160<span class="mirc_bracket">)</span> test |<a href="http://en.wikichip.org/wiki/mirc/commands/reload" title="/reload - mIRC Command" style="text-decoration: none"><span class="mirc_command"> .reload</span></a> -rs999 <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>160<span class="mirc_bracket">)</span></span></pre>
<p>This creates a file without a filetype, where the filename itself is not visible in most fonts, then loads it as a remote script. All you see in the script editor&#39;s &#34;view&#34; menu is an extra-thick border at the bottom of the scripts list, and if you have too many scripts loaded, it&#39;s hiding inside the &#34;more&#34; list. This next command lists all the scripts you have loaded. If you see a line showing nothing between the double quotes or is something you don&#39;t recognize, you should investigate and possibly unload it.
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> <span class="mirc_variable">%i</span> 1 | <span class="mirc_control">while</span> <span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$script" title="$script - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$script</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%i<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span> <span class="mirc_bracket">{</span><a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a <span class="mirc_variable">%i</span> : <a href="http://en.wikichip.org/wiki/mirc/identifiers/$qt" title="$qt - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$qt</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$nopath" title="$nopath - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nopath</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$script" title="$script - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$script</span></a><span class="mirc_bracket">(</span><span class="mirc_variable">%i<span class="mirc_bracket">)</span><span class="mirc_bracket">)</span><span class="mirc_bracket">)</span></span> |<a href="http://en.wikichip.org/wiki/mirc/commands/inc" title="/inc - mIRC Command" style="text-decoration: none"><span class="mirc_command"> inc</span></a> <span class="mirc_variable">%i</span> <span class="mirc_bracket">}</span></span></pre>
<ul><li> Restricting DCC Get filetypes.</li></ul>
<p>You should view the contents of your downloads folder with suspicion if you don&#39;t know from whom you received the file. If you disable filetype blocking, you should do it temporarily, by using the &#34;turn ignore back on in xx minutes&#34; feature, which causes the &#39;disable&#39; choice to revert back to the prior &#39;accept only&#39; or &#39;ignore only&#39; setting.<br/>
</p><p>While you can either configure Options/DCC/Ignore as &#39;ignore only&#39; to specify a list of filetypes to be blocked, or as &#39;accept only&#39; to specify a list of the only filetypes accepted, &#39;ignore only&#39; requires updating the list as new executable filetypes need to be added. It&#39;s probably better to use &#39;accept only&#39;, since this allows you to manage the list of the only filetypes which are accepted. You should block all executable filetypes, without expecting to be able to inspect the download folder for suspicious items.
</p>
<pre><span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/var" title="/var - mIRC Command" style="text-decoration: none"><span class="mirc_command">//var</span></a> <span class="mirc_variable">%a</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$chr" title="$chr - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$chr</span></a><span class="mirc_bracket">(</span>8238<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$+" title="$+ - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$+</span></a> piz.!wen.oediv.ezicr.exe |<a href="http://en.wikichip.org/wiki/mirc/commands/echo" title="/echo - mIRC Command" style="text-decoration: none"><span class="mirc_command"> echo</span></a> -a write <span class="mirc_variable">%a</span> test</span></pre>
<p>As you can see from the above command, this is a filename ending with .exe, which means it&#39;s an executible filetype. However, if your windows font is unicode-aware, and you use &#34;/run .&#34; to view the contents of your mirc folder, you&#39;ll see that this .exe file appears as if it&#39;s a .zip file. If someone created an .exe file containing the icon normally associated with .zip files, then renames it to this filename, and then uses DCC to send this file to you - it would appear as if it&#39;s a .zip file that&#39;s safe to click on to view the contents. This next event handler creates a log of the files you&#39;ve received via DCC, and allows you to check later to see who sent an unknown file to you.
</p>
<pre><span class="code_line"><span class="mirc_control">on</span> *:<span class="mirc_control">FILERCVD</span>:*:<span class="mirc_bracket">{</span></span>
<span class="code_line"><a href="http://en.wikichip.org/wiki/mirc/commands/write" title="/write - mIRC Command" style="text-decoration: none"><span class="mirc_command">  write</span></a> getlog.txt <a href="http://en.wikichip.org/wiki/mirc/identifiers/$time" title="$time - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$time</span></a><span class="mirc_bracket">(</span>yyyy.mm.dd HH:nn:ss<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$network" title="$network - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$network</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$get" title="$get - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$get</span></a><span class="mirc_bracket">(</span>-1<span class="mirc_bracket">)</span>.ip <a href="http://en.wikichip.org/wiki/mirc/identifiers/$address" title="$address - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$address</span></a><span class="mirc_bracket">(</span><a href="http://en.wikichip.org/wiki/mirc/identifiers/$nick" title="$nick - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$nick</span></a>,5<span class="mirc_bracket">)</span> <a href="http://en.wikichip.org/wiki/mirc/identifiers/$get" title="$get - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$get</span></a><span class="mirc_bracket">(</span>-1<span class="mirc_bracket">)</span>.size file: <a href="http://en.wikichip.org/wiki/mirc/identifiers/$filename" title="$filename - mIRC Identifier" style="text-decoration: none"><span class="mirc_identifier">$filename</span></a></span>
<span class="code_line"><span class="mirc_bracket">}</span></span></pre>
<h1><span class="mw-headline" id="Injection_via_server_command">Injection via server command</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=mirc/msl_injection&amp;action=edit&amp;section=17" title="Edit section: Injection via server command">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>IRC servers accept strings containing $crlf $lf or $cr and will execute text following the line-ending as a 2nd server command using whatever permissions belong to your nick at that time.
</p>
<pre>//msg #channel message $crlf mode #home +o Mallory
</pre>
<p>When the server  receives this message from mIRC, it uses the $crlf to split this into 2 commands. The first command displays the message to #channel, and the 2nd command tells the server to give @op status in channel #home to Mallory. If you do not have permissions in #home to give @ops, or if a nick Mallory is not in that channel, nothing happens. But if both are true, then you have just given op status to Mallory.
</p><p>This method can only tell the server to execute commands recognized by the server. It does not know any mIRC-only /commands or $identifiers, and the 2nd command is executed even if the 1st command is invalid, such as #channel not existing. This means echoing such a string is no danger, because /echo will not send any string to a server, and it will not execute them either.
</p><p>This exploit cannot be achieved by responding to an ON TEXT command, because the server cannot display a message to a channel which contains an embedded $cr and/or $lf.
</p><p>However, this exploit can take advantage of scripts which send text to channels which can contain them. Examples could include the above examples of an evaluated command inside a $decode string, or can be accomplished by a script which messages the title/description or other content from a webpage that the attacker controls. Another method can be &#39;now playing&#39; scripts which message text to channel describing information about the mp3 song that is either beginning or ending. While it&#39;s common for fields like $sound(filename.mp3).comment to contain $cr&#39;s, they generally are not displayed in channel messages. However, it&#39;s also possible for Album or Title to also contain them.
</p><p>In addition to executing commands to give @op privileges to someone, the malicious commands could include things like making you drop your nickserv account at some ircd&#39;s. Also, they can induce you to execute commands which have a future effect, such as adding a nick to a chanserv access list, or a command to add Mallory&#39;s certificate fingerprint to your nickserv account, which would allow them to take channel actions in the future, or to login your nickserv account any time in the future, even if you change your nickserv password. While those would almost certainly trigger a confirmation message from chanserv or nickserv, those messages often go into the status window, and would often be unseen, especially if they happened while your keyboard is unattended.
</p><p>To defend against such an exploit, any command sent to the server (not only a channel message) containing text that could come from a source which contains line-ending characters should be sanitized to remove/disable them.
</p>
<pre>$remove(string,$cr,$lf)
</pre>
<p>This sanitizing would cause both strings to be combined as a single string, so if the first message is a plausible channel message, the hidden message is displayed as part of the channel message
</p><p>However, this is not sufficient if the first server command is able to cause damage even if combined with additional text, such as when the first command is the give-them-@ops command. The better defense is to halt the server command if the string contains a $cr and/or $lf that shouldn&#39;t be there:
</p>
<pre>if ($cr isin $replace(string,$lf,$cr)) { echo -a string exploit attempt: $2 | halt }
</pre>

<!-- Saved in parser cache with key wikichip:pcache:idhash:38-0!*!0!!en!*!* and timestamp 20240225005706 and revision id 101076
 -->
</div><div class="visualClear"></div><div class="printfooter">Retrieved from &#34;<a dir="ltr" href="/w/index.php?title=mirc/msl_injection&amp;oldid=101076">/w/index.php?title=mirc/msl_injection&amp;oldid=101076</a>&#34;</div><div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>				</div>
				
</div> <!-- mw-body-content END -->
</div> <!-- mw-body-content enclosure END -->
</div> <!-- wikichip-body-container END -->
<!-- wikichip-bottom START -->
<div id="wikichip-bottom">
    <!-- wikichip-footer-cont START -->
    <div id="wikichip-footer-cont">
    <!-- wikichip-afooter START -->
        <div id="wikichip-afooter">
                    	
			<!-- Ezoic - wikichip/global/footer - bottom_of_page -->
			<div id="ezoic-pub-ad-placeholder-127">
                	        <script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                	        <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1951113009523412" data-ad-slot="3591436790" data-ad-format="auto"></ins>
                	        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
			</div>
			<!-- End Ezoic - wikichip/global/footer - bottom_of_page -->

			                            </div>
    <!-- wikichip-afooter END -->
    <!-- wikichip-footer START -->
        <div id="wikichip-footer">

                                <div id="footer-last-mod">
                         This page was last modified on 21 January 2023, at 07:43.                        </div>
                                <div id="footer-places"><ul>
                        <li><a href="/wiki/WikiChip:Privacy_policy" title="WikiChip:Privacy policy">Privacy policy</a></li><li><a href="/wiki/WikiChip:About" title="WikiChip:About">About WikiChip</a></li><li><a href="/wiki/WikiChip:General_disclaimer" title="WikiChip:General disclaimer">Disclaimers</a></li>                        </ul></div>
                        
        </div>
    <!-- wikichip-footer END -->
    </div>
    <!-- wikichip-footer-cont END -->
</div>
<!-- wikichip-bottom START -->
 
    
    
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.smw.tooltips","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.headertabs","ext.headertabs.large","skins.WikiChip2.js"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":110});});</script></div>
<!-- A:IL01 START -->
<script type="text/javascript"> var infolinks_pid = 3234819; var infolinks_wsid = 0;</script>
<script type="text/javascript" src="//resources.infolinks.com/js/infolinks%5Fmain.js"></script>
<!-- A:IL01 END -->




<script>__ez.queue.addFile('/tardisrocinante/vitals.js', '/tardisrocinante/vitals.js?gcb=3&cb=3', false, ['/parsonsmaize/mulvane.js'], true, false, true, false);</script>
<script>var _audins_dom="wikichip_org",_audins_did=86609;__ez.queue.addDelayFunc("audins.js","__ez.script.add", "//go.ezodn.com/detroitchicago/audins.js?cb=3");</script><noscript><div style="display:none;"><img src="//pixel.quantserve.com/pixel/p-31iz6hfFutd16.gif?labels=Domain.wikichip_org,DomainId.86609" border="0" height="1" width="1" alt="Quantcast"/></div></noscript>
<script>__ez.queue.addFile('/beardeddragon/drake.js', '/beardeddragon/drake.js?gcb=3&cb=8', false, [], true, false, true, false);</script>
<script type="text/javascript" style='display:none;'>var __ez_dims = (function() {
		var setCookie = function( name, content, expiry ) {
			return document.cookie = name+'='+content+((expiry)?';expires='+(new Date(Math.floor(new Date().getTime()+expiry*1000)).toUTCString()):'')+';path=/';
		};
		var ffid = 1;
		var oh = window.screen.height;
		var ow = window.screen.width;
		var h = ffid === 1 ? oh : (oh > ow) ? oh : ow;
		var w = ffid === 1 ? ow : (oh > ow) ? ow : oh;
		var uh = window.innerHeight || document.documentElement.clientHeight || document.getElementsByTagName('body')[0].clientHeight;
		var uw = window.innerWidth || document.documentElement.clientWidth || document.getElementsByTagName('body')[0].clientWidth;
	
		var setAllCookies = function() {
			setCookie('ezds', encodeURIComponent('ffid='+ffid+',w='+w+',h='+h), (31536e3*7));
			setCookie('ezohw', encodeURIComponent('w='+uw+',h='+uh), (31536e3*7));    
		};
	
		if (window.ezTcfConsent && window.ezTcfConsent.loaded) {
			if (window.ezTcfConsent.understand_audiences) { 
				setAllCookies();
			}
		} else if (typeof getEzConsentData === "function") {
			getEzConsentData().then(function (ezTcfConsent) {
				if (ezTcfConsent && ezTcfConsent.loaded) {
					if (ezTcfConsent.understand_audiences) { 
						setAllCookies();
					}
				} else {
					console.error("cannot get ez consent data");
					setAllCookies();
				}
			});
		} else {
			console.error("getEzConsentData is not a function");
			setAllCookies();
		}
	
	})();</script>
<script type='text/javascript' style='display:none;' async>__ez.queue.addFile('/parsonsmaize/chanute.js', '/parsonsmaize/chanute.js?a=a&cb=9&dcb=195-3&shcb=34', true, ['/parsonsmaize/mulvane.js'], true, false, false, false);</script>
<script type='text/javascript' style='display:none;' async>__ez.queue.addFile('/porpoiseant/jellyfish.js', '/porpoiseant/jellyfish.js?a=a&cb=13&dcb=195-3&shcb=34', false, [], true, false, false, false);</script>
<script>if(typeof _ezaq!=="undefined"&&typeof __ez=="object"&&typeof __ez.bit=="object"&&typeof __ezDotData=="function"){if("cookieDeprecationLabel"in navigator){navigator.cookieDeprecationLabel.getValue().then((label)=>{__ez.bit.AddAndFire(_ezaq["page_view_id"],[new __ezDotData("chrome_cookie_deprecation_label",label),]);});}}</script><script data-cfasync="false">function _emitEzConsentEvent(){var customEvent=new CustomEvent("ezConsentEvent",{detail:{ezTcfConsent:window.ezTcfConsent},bubbles:true,cancelable:true,});document.dispatchEvent(customEvent);}
(function(window,document){function _setAllEzConsentTrue(){window.ezTcfConsent.loaded=true;window.ezTcfConsent.store_info=true;window.ezTcfConsent.develop_and_improve_services=true;window.ezTcfConsent.measure_ad_performance=true;window.ezTcfConsent.measure_content_performance=true;window.ezTcfConsent.select_basic_ads=true;window.ezTcfConsent.create_ad_profile=true;window.ezTcfConsent.select_personalized_ads=true;window.ezTcfConsent.create_content_profile=true;window.ezTcfConsent.select_personalized_content=true;window.ezTcfConsent.understand_audiences=true;window.ezTcfConsent.use_limited_data_to_select_content=true;window.ezTcfConsent.select_personalized_content=true;}
function _clearEzConsentCookie(){document.cookie="ezCMPCookieConsent=tcf2;Domain=.wikichip.org;Path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT";}
_clearEzConsentCookie();if(typeof window.__tcfapi!=="undefined"){window.ezgconsent=false;var amazonHasRun=false;function _ezAllowed(tcdata,purpose){return(tcdata.purpose.consents[purpose]||tcdata.purpose.legitimateInterests[purpose]);}
function _reloadAds(){if(typeof window.ezorefgsl==="function"&&typeof window.ezslots==="object"){if(typeof __ezapsFetchBids=="function"&&amazonHasRun===false){ezapsFetchBids(__ezaps);if(typeof __ezapsVideo!="undefined"){ezapsFetchBids(__ezapsVideo,"video");}
amazonHasRun=true;}
var slots=[];for(var i=0;i<window.ezslots.length;i++){if(window[window.ezslots[i]]&&typeof window[window.ezslots[i]]==="object"){slots.push(window[window.ezslots[i]]);}else{setTimeout(_reloadAds,100);return false;}}
for(var i=0;i<slots.length;i++){window.ezorefgsl(slots[i]);}}else if(!window.ezadtimeoutset){window.ezadtimeoutset=true;setTimeout(_reloadAds,100);}}
function _handleConsentDecision(tcdata){window.ezTcfConsent.loaded=true;if(!tcdata.vendor.consents["347"]&&!tcdata.vendor.legitimateInterests["347"]){window._emitEzConsentEvent();return;}
window.ezTcfConsent.store_info=_ezAllowed(tcdata,"1");window.ezTcfConsent.develop_and_improve_services=_ezAllowed(tcdata,"10");window.ezTcfConsent.measure_content_performance=_ezAllowed(tcdata,"8");window.ezTcfConsent.select_basic_ads=_ezAllowed(tcdata,"2");window.ezTcfConsent.create_ad_profile=_ezAllowed(tcdata,"3");window.ezTcfConsent.select_personalized_ads=_ezAllowed(tcdata,"4");window.ezTcfConsent.create_content_profile=_ezAllowed(tcdata,"5");window.ezTcfConsent.measure_ad_performance=_ezAllowed(tcdata,"7");window.ezTcfConsent.use_limited_data_to_select_content=_ezAllowed(tcdata,"11");window.ezTcfConsent.select_personalized_content=_ezAllowed(tcdata,"6");window.ezTcfConsent.understand_audiences=_ezAllowed(tcdata,"9");window._emitEzConsentEvent();}
__tcfapi("addEventListener",2,function(tcdata,success){if(!success||!tcdata){window._emitEzConsentEvent();return;}
if(!tcdata.gdprApplies){_setAllEzConsentTrue();window._emitEzConsentEvent();return;}
if(tcdata.eventStatus==="useractioncomplete"||tcdata.eventStatus==="tcloaded"){_handleConsentDecision(tcdata);if(tcdata.purpose.consents["1"]===true&&tcdata.vendor.consents["755"]!==false){window.ezgconsent=true;(adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0;_reloadAds();}else{_reloadAds();}
if(window.__ezconsent){__ezconsent.setEzoicConsentSettings(ezConsentCategories);}
__tcfapi("removeEventListener",2,function(success){return null;},tcdata.listenerId);if(!(tcdata.purpose.consents["1"]===true&&_ezAllowed(tcdata,"2")&&_ezAllowed(tcdata,"3")&&_ezAllowed(tcdata,"4"))){if(typeof __ez=="object"&&typeof __ez.bit=="object"&&typeof window["_ezaq"]=="object"&&typeof window["_ezaq"]["page_view_id"]=="string"){__ez.bit.AddAndFire(window["_ezaq"]["page_view_id"],[new __ezDotData("non_personalized_ads",true),]);}}}});}else{_setAllEzConsentTrue();window._emitEzConsentEvent();}})(window,document);</script></body></html>